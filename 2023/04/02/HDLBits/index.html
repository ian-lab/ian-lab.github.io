<!DOCTYPE html>
<html>
  <!-- meta/link... -->
  



<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <!-- Global site tag (gtag.js) - Google Analytics -->


  <title>HDLBits | ian-blog</title>

  <link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://at.alicdn.com/t/font_1911880_c1nvbyezg17.css">
  <link href="https://cdn.jsdelivr.net/gh/inkss/fontawesome@5.15.3/css/all.min.css" rel="stylesheet">

  
  
  
<link rel="stylesheet" href="/css/animate.min.css">

  
<link rel="stylesheet" href="/css/style.css">

  
  
  
    
<link rel="stylesheet" href="/js/shareJs/share.min.css">

  
  <style>
        @media (max-width: 992px) {
            #waifu {
                display: none;
            }
        }
    </style>
    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">

    

    <!-- import link -->
    
        
            
        
            
        
    
    <!-- import script -->
    
        
            
        
            
        
    

<meta name="generator" content="Hexo 5.4.0"></head>

  
  <!-- 依赖于jquery和vue -->
  <script src="/js/jquery3.5.1.js"></script>
  <script src="/js/vue2.6.11.js"></script>
  
  <body>
    <!-- 预加载动画 -->
    <!-- 页面预加载动画 -->

<div id='loader'>
  <link rel="stylesheet" href="/js/loaded/index.css" >
  <div class="loading-left-bg"></div>
  <div class="loading-right-bg"></div>
  <div class="spinner-box">
    <div class="configure-border-1">
      <div class="configure-core"></div>
    </div>
    <div class="configure-border-2">
      <div class="configure-core"></div>
    </div>
    <div class="loading-word">加载中...</div>
  </div>
</div>

<script>
  var endLoading = function () {
    document.body.style.overflow = 'auto';
    document.getElementById('loader').classList.add("loading");
  }
  window.addEventListener('DOMContentLoaded',endLoading);
  
</script>

    
    <!-- 判断是否为暗黑风格 -->
    <!-- 判断是否为黑夜模式 -->
<script>
  let isDark = JSON.parse(localStorage.getItem('dark')) || JSON.parse('false');

  if (isDark) {
    $(document.body).addClass('darkModel');
  }
</script>

    <!-- 头部导航等 -->
    
<header class="header " id="navHeader"
  style="position: fixed;
  left: 0; top: 0; z-index: 10;width: 100%;"
>
  <div class="header-content">
    <div class="bars">
      <div id="appDrawer" class="sidebar-image">
  <div class="drawer-box-icon">
    <i class="fas fa-bars" aria-hidden="true" @click="showDialogDrawer"></i>
  </div>
  
  <transition name="fade">
    <div class="drawer-box_mask" v-cloak style="display: none;" v-show="visible" @click.self="cancelDialogDrawer">
    </div>
  </transition>
  <div class="drawer-box" :class="{'active': visible}">
    <div class="drawer-box-head bg-color">
      <img class="drawer-box-head_logo lazyload placeholder" src="/medias/kide.jpg" class="lazyload placeholder" data-srcset="/medias/kide.jpg" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg" alt="logo">
      <h3 class="drawer-box-head_title">ian-blog</h3>
      <h5 class="drawer-box-head_desc"></h5>
    </div>
    
    <div class="drawer-box-content">
      <ul class="drawer-box-content_menu">
        
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/" class="drawer-menu-item-link">
                  
                    <i class="fas fa-home" aria-hidden="true"></i>
                  
                  <span class="name">首页</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/archives" class="drawer-menu-item-link">
                  
                    <i class="fas fa-archive" aria-hidden="true"></i>
                  
                  <span class="name">归档</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/tags" class="drawer-menu-item-link">
                  
                    <i class="fas fa-tags" aria-hidden="true"></i>
                  
                  <span class="name">标签</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/categories" class="drawer-menu-item-link">
                  
                    <i class="fas fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">分类</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/about" class="drawer-menu-item-link">
                  
                    <i class="fas fa-user" aria-hidden="true"></i>
                  
                  <span class="name">关于</span>
                </a>
              
            </li>
          
        
        
      </ul>
    </div>
  </div>
</div>

<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appDrawer',
    data: {
      visible: false,
      top: 0,
      openArr: [],
    },
    computed: {
    },
    mounted() {
    },
    methods: {
      isOpen(index) {
        if (this.openArr.includes(index)) {
          return true;
        } else {
          return false;
        }
      },
      openOrCloseMenu(curIndex) {
        const index = this.openArr.indexOf(curIndex);
        if (index !== -1) {
          this.openArr.splice(index, 1);
        } else {
          this.openArr.push(curIndex);
        }
      },
      showDialogDrawer() {
        this.visible = true;
        // 防止页面滚动，只能让弹框滚动
        this.top = $(document).scrollTop()
        body.style.cssText = 'width: 100%; height: 100%;overflow: hidden;';
      },
      cancelDialogDrawer() {
        this.visible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      }
    },
    created() {}
  })
</script>

    </div>
    <div class="blog-title" id="author-avatar">
      
        <div class="avatar">
          <img src="/medias/kide.jpg" class="lazyload placeholder" data-srcset="/medias/kide.jpg" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg" alt="logo">
        </div>
      
      <a href="/" class="logo">ian-blog</a>
    </div>
    <nav class="navbar">
      <ul class="menu">
        
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/" class="menu-item-link" title="首页">
                  
                    <i class="fas fa-home" aria-hidden="true"></i>
                  
                  <span class="name">首页</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/archives" class="menu-item-link" title="归档">
                  
                    <i class="fas fa-archive" aria-hidden="true"></i>
                  
                  <span class="name">归档</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/tags" class="menu-item-link" title="标签">
                  
                    <i class="fas fa-tags" aria-hidden="true"></i>
                  
                  <span class="name">标签</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/categories" class="menu-item-link" title="分类">
                  
                    <i class="fas fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">分类</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/about" class="menu-item-link" title="关于">
                  
                    <i class="fas fa-user" aria-hidden="true"></i>
                  
                  <span class="name">关于</span>
                </a>
              
            </li>
          
        
      </ul>
      
      
        <div id="appSearch">
  <div class="search"  @click="showDialog()"><i class="fas fa-search" aria-hidden="true"></i></div>
  <transition name="fade">
    <div class="message-box_wrapper" style="display: none;" v-cloak v-show="dialogVisible" @click.self="cancelDialogVisible()">
      <div class="message-box animated bounceInDown">
        <h2>
          <span>
            <i class="fas fa-search" aria-hidden="true"></i>
            <span class="title">本地搜索</span>
          </span>
          <i class="fas fa-times close" pointer style="float:right;" aria-hidden="true" @click.self="cancelDialogVisible()"></i>
        </h2>
        <form class="site-search-form">
          <input type="text"
            placeholder="请输入关键字"
            id="local-search-input" 
            @click="getSearchFile()"
            class="st-search-input"
            v-model="searchInput"
          />
        </form>
        <div class="result-wrapper">
          <div id="local-search-result" class="local-search-result-cls"></div>
        </div>
      </div>
    </div>
  </transition>
</div>
<script src="/js/local_search.js"></script>
<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appSearch',
    data: {
      dialogVisible: false,
      searchInput: '',
      top: 0,
    },
    computed: {
    },
    mounted() {
      window.addEventListener('pjax:complete', () => {
        this.cancelDialogVisible();
      })
    },
    methods: {
      showDialog() {
        this.dialogVisible = true;
        // 防止页面滚动，只能让弹框滚动
        this.top = $(document).scrollTop()
        body.style.cssText = 'overflow: hidden;';
      },
      getSearchFile() {
        if (!this.searchInput) {
          getSearchFile("/search.xml");
        }
      },
      cancelDialogVisible() {
        this.dialogVisible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      },
    },
    created() {}
  })
</script>
<!-- 解决刷新页面闪烁问题，可以在元素上添加display: none, 或者用vue.extend方法，详情：https://blog.csdn.net/qq_31393401/article/details/81017912 -->
<!-- 下面是搜索基本写法 -->
<!-- <script type="text/javascript" id="local.search.active">
  var inputArea = document.querySelector("#local-search-input");
  inputArea.onclick   = function(){ getSearchFile(); this.onclick = null }
  inputArea.onkeydown = function(){ if(event.keyCode == 13) return false }
</script> -->

      

    </nav>
  </div>
  
  
    <div id="he-plugin-simple"></div>
    <script>
      WIDGET = {
        CONFIG: {
          "modules": "012",
          "background": 5,
          "tmpColor": "4A4A4A",
          "tmpSize": 16,
          "cityColor": "4A4A4A",
          "citySize": 16,
          "aqiSize": 16,
          "weatherIconSize": 24,
          "alertIconSize": 18,
          "padding": "10px 10px 10px 10px",
          "shadow": "1",
          "language": "auto",
          "borderRadius": 5,
          "fixed": "false",
          "vertical": "middle",
          "horizontal": "center",
          "key": "2784dd3fcb1e4f0f9a9b579bf69641f2"
        }
      }
    </script>
    <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script> 
    

    <!-- 当头部导航设置为背景透明的时候  -->
    
      <script src="/js/header/index.js" data-pjax></script>
    
</header>

    <!-- 需要在上面加载的js -->
    <script>
  function loadScript(src, cb) {
    return new Promise(resolve => {
      setTimeout(function () {
        var HEAD = document.getElementsByTagName("head")[0] || document.documentElement;
        var script = document.createElement("script");
        script.setAttribute("type", "text/javascript");
        if (cb) {
          if (JSON.stringify(cb)) {
            for (let p in cb) {
              if (p == "onload") {
                script[p] = () => {
                  cb[p]()
                  resolve()
                }
              } else {
                script[p] = cb[p]
                script.onload = resolve
              }
            }
          } else {
            script.onload = () => {
              cb()
              resolve()
            };
          }
        } else {
          script.onload = resolve
        }
        script.setAttribute("src", src);
        HEAD.appendChild(script);
      });
    });
  }

  //https://github.com/filamentgroup/loadCSS
  var loadCSS = function (href, before, media, attributes) {
    return new Promise(resolve => {
      setTimeout(function () {
        var link = document.createElement('link');
        link.rel = "stylesheet";
        link.href = src;
        link.onload = resolve;
        document.getElementsByTagName("head")[0].appendChild(link);
      });
    });
  };

</script> 

<!-- 轮播图所需要的js -->
<script src="/js/swiper/swiper.min.js"></script>
<script src="/js/swiper/vue-awesome-swiper.js"></script>
<script src="/js/swiper/swiper.animate1.0.3.min.js"></script>


  <script src="/js/vue-typed-js/index.js"></script>


<!-- 首页的公告滚动插件的js需要重新加载 -->
<script src="/js/vue-seamless-scroll/index.js"></script>

<!-- 打字机效果js -->
<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11"></script>


    <!-- 内容区域 -->
    <div id="safearea">
      <main class="main" id="pjax-container" style="margin-top: 0;">
        
 <!-- prismjs 代码高亮 -->
 


<div class="bg-dark-floor" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -1;"></div>

<!-- 文章详情页顶部图片和标题 -->




<div class="post-detail-header" id="thumbnail_canvas" style="background-repeat: no-repeat; background-size: cover; 
  background-position: center center;position: relative;background-image:url('/medias/4.jpg')">
  <div class="post-detail-header-mask"></div>
  <canvas id="header_canvas"style="position:absolute;bottom:0;pointer-events:none;"></canvas>
  
  <div class="post-detail-header_info-box">
    <div class="title-box">
      <span class="title">
        HDLBits
      </span>
    </div>
    
    
      
        <span class="post-detail-header_date">
          <i class="fas fa-calendar"></i> 发表于：2023-04-02 |
        </span>
      

      
        <span class="post-detail-header_categories">
          <i class="iconfont iconbookmark1"></i> 分类：
          
            <a href="/categories/Verilog/" class="post-detail-header_category">
              Verilog
            </a>
          
        </span>
      

      
    
  </div>
  
  
    <script src="/js/bubble/bubble.js"></script>
  
</div>



<div class="row justify-position">
  <div class="main-content">
    <article class="post post-detail">
      <div class="post-content">
        <h2 id="1-Getting-Started"><a href="#1-Getting-Started" class="headerlink" title="1 Getting Started"></a>1 Getting Started</h2><h3 id="1-1-Getting-Started-Output-one"><a href="#1-1-Getting-Started-Output-one" class="headerlink" title="1.1 Getting Started (Output one)"></a>1.1 Getting Started (Output one)</h3><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( <span class="keyword">output</span> one );</span><br><span class="line">    <span class="keyword">assign</span> one = <span class="number">1&#x27;b1</span>;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h3 id="1-2-Output-zero"><a href="#1-2-Output-zero" class="headerlink" title="1.2 Output zero"></a>1.2 Output zero</h3><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( <span class="keyword">output</span> zero);</span><br><span class="line">	<span class="keyword">assign</span> zero = <span class="number">1&#x27;b0</span>;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h2 id="2-Verilog-Language"><a href="#2-Verilog-Language" class="headerlink" title="2 Verilog Language"></a>2 Verilog Language</h2><h3 id="2-1-Basic"><a href="#2-1-Basic" class="headerlink" title="2.1 Basic"></a>2.1 Basic</h3><p>2.1.1 Simple wire<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( <span class="keyword">input</span> in, <span class="keyword">output</span> out );</span><br><span class="line">	<span class="keyword">assign</span> out = in;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.1.2 Four wires</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> a,b,c,</span><br><span class="line">    <span class="keyword">output</span> w,x,y,z );</span><br><span class="line">	<span class="keyword">assign</span> w = a;</span><br><span class="line">	<span class="keyword">assign</span> x = b;</span><br><span class="line">	<span class="keyword">assign</span> y = b;</span><br><span class="line">	<span class="keyword">assign</span> z = c;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>2.1.3 Inverter<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( <span class="keyword">input</span> in, <span class="keyword">output</span> out );</span><br><span class="line">	<span class="keyword">assign</span> out = ~in;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.1.4 AND gate</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> a, </span><br><span class="line">    <span class="keyword">input</span> b, </span><br><span class="line">    <span class="keyword">output</span> out );</span><br><span class="line">	<span class="keyword">assign</span> out = a &amp; b;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>2.1.5 NOR gate<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> a, </span><br><span class="line">    <span class="keyword">input</span> b, </span><br><span class="line">    <span class="keyword">output</span> out );</span><br><span class="line">    <span class="keyword">assign</span> out = ~(a|b);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.1.6 XNOR gate<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> a, </span><br><span class="line">    <span class="keyword">input</span> b, </span><br><span class="line">    <span class="keyword">output</span> out );</span><br><span class="line">    <span class="keyword">assign</span> out = (a &amp; b) + (!a &amp; !b);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.1.7 Declaring wires<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="meta-keyword">default_nettype</span> none</span></span><br><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">input</span> b,</span><br><span class="line">    <span class="keyword">input</span> c,</span><br><span class="line">    <span class="keyword">input</span> d,</span><br><span class="line">    <span class="keyword">output</span> out,</span><br><span class="line">    <span class="keyword">output</span> out_n   );</span><br><span class="line">    <span class="keyword">wire</span> one,two;</span><br><span class="line">    <span class="keyword">assign</span> one = a &amp; b;</span><br><span class="line">    <span class="keyword">assign</span> two = c &amp; d;</span><br><span class="line">    <span class="keyword">assign</span> out = one | two;</span><br><span class="line">    <span class="keyword">assign</span> out_n = ~out;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.1.8 7458 chip<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module ( </span><br><span class="line">    <span class="keyword">input</span> p1a, p1b, p1c, p1d, p1e, p1f,</span><br><span class="line">    <span class="keyword">output</span> p1y,</span><br><span class="line">    <span class="keyword">input</span> p2a, p2b, p2c, p2d,</span><br><span class="line">    <span class="keyword">output</span> p2y );</span><br><span class="line">    <span class="keyword">assign</span> p1y = (p1a &amp; p1b &amp; p1c) | (p1d &amp; p1e &amp; p1f);</span><br><span class="line">    <span class="keyword">assign</span> p2y = (p2a &amp; p2b ) | (p2c &amp; p2d);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<h3 id="2-2-Vectors"><a href="#2-2-Vectors" class="headerlink" title="2.2 Vectors"></a>2.2 Vectors</h3><p>2.2.1 Vectors<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module ( </span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> [<span class="number">2</span>:<span class="number">0</span>] vec,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">2</span>:<span class="number">0</span>] outv,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> o2,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> o1,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> o0  ); </span><br><span class="line">	<span class="keyword">assign</span> outv = vec;</span><br><span class="line">    <span class="keyword">assign</span> &#123;o2,o1,o0&#125; = vec;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.2.2 Vectors in more detail<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="meta-keyword">default_nettype</span> none     // Disable implicit nets. Reduces some types of bugs.</span></span><br><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] out_hi,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] out_lo );</span><br><span class="line">    <span class="keyword">assign</span> out_hi = in[<span class="number">15</span>:<span class="number">8</span>];</span><br><span class="line">    <span class="keyword">assign</span> out_lo = in[<span class="number">7</span>:<span class="number">0</span>]; </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.2.3 Vector part select</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">31</span>:<span class="number">0</span>] out );</span><br><span class="line">    <span class="keyword">assign</span> out[<span class="number">31</span>:<span class="number">24</span>] = in[<span class="number">7</span>:<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">assign</span> out[<span class="number">23</span>:<span class="number">16</span>] = in[<span class="number">15</span>:<span class="number">8</span>];</span><br><span class="line">    <span class="keyword">assign</span> out[<span class="number">15</span>:<span class="number">8</span>] = in[<span class="number">23</span>:<span class="number">16</span>];</span><br><span class="line">    <span class="keyword">assign</span> out[<span class="number">7</span>:<span class="number">0</span>] = in[<span class="number">31</span>:<span class="number">24</span>];</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>2.2.4 Bitwise operators<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">2</span>:<span class="number">0</span>] a,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">2</span>:<span class="number">0</span>] b,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">2</span>:<span class="number">0</span>] out_or_bitwise,</span><br><span class="line">    <span class="keyword">output</span> out_or_logical,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">5</span>:<span class="number">0</span>] out_no );</span><br><span class="line">    <span class="keyword">assign</span> out_or_bitwise = a | b;</span><br><span class="line">    <span class="keyword">assign</span> out_or_logical = a || b;</span><br><span class="line">    <span class="keyword">assign</span> out_not[<span class="number">5</span>:<span class="number">3</span>] = ~b;</span><br><span class="line">    <span class="keyword">assign</span> out_not[<span class="number">2</span>:<span class="number">0</span>] = ~a;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.2.5 Four-input gates</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> out_and,</span><br><span class="line">    <span class="keyword">output</span> out_or,</span><br><span class="line">    <span class="keyword">output</span> out_xor );</span><br><span class="line">    <span class="keyword">assign</span> out_and = in[<span class="number">3</span>] &amp; in[<span class="number">2</span>] &amp; in[<span class="number">1</span>] &amp; in[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">assign</span> out_or  = in[<span class="number">3</span>] | in[<span class="number">2</span>] | in[<span class="number">1</span>] | in[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">assign</span> out_xor = in[<span class="number">3</span>] ^ in[<span class="number">2</span>] ^ in[<span class="number">1</span>] ^ in[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>2.2.6 Vector concatenation operator<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">4</span>:<span class="number">0</span>] a, b, c, d, e, f,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] w, x, y, z );</span><br><span class="line">    <span class="keyword">assign</span> w = &#123;a, b[<span class="number">4</span>:<span class="number">2</span>] &#125;;</span><br><span class="line">    <span class="keyword">assign</span> x = &#123;b[<span class="number">1</span>:<span class="number">0</span>], c, d[<span class="number">4</span>] &#125;;</span><br><span class="line">    <span class="keyword">assign</span> y = &#123;d[<span class="number">3</span>:<span class="number">0</span>], e[<span class="number">4</span>:<span class="number">1</span>] &#125;;</span><br><span class="line">    <span class="keyword">assign</span> z = &#123;e[<span class="number">0</span>], f, <span class="number">2&#x27;b11</span>&#125;;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.2.7 Vector reversal 1<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] out);</span><br><span class="line">    <span class="keyword">assign</span> &#123;out[<span class="number">7</span>], out[<span class="number">6</span>], out[<span class="number">5</span>], out[<span class="number">4</span>], out[<span class="number">3</span>], out[<span class="number">2</span>], out[<span class="number">1</span>], out[<span class="number">0</span>] &#125; = &#123;in[<span class="number">0</span>], in[<span class="number">1</span>], in[<span class="number">2</span>], in[<span class="number">3</span>], in[<span class="number">4</span>], in[<span class="number">5</span>], in[<span class="number">6</span>], in[<span class="number">7</span>]&#125;;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.2.8 Replication operator<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">31</span>:<span class="number">0</span>] out );</span><br><span class="line">    <span class="keyword">assign</span> out = &#123; &#123;<span class="number">24</span>&#123;in[<span class="number">7</span>]&#125;&#125; , in &#125;;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.2.9 More replication<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> a, b, c, d, e,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">24</span>:<span class="number">0</span>] out );</span><br><span class="line">    <span class="comment">// The output is XNOR of two vectors created by </span></span><br><span class="line">    <span class="comment">// concatenating and replicating the five inputs.</span></span><br><span class="line">    <span class="keyword">assign</span> out = ~&#123; &#123;<span class="number">5</span>&#123;a&#125;&#125;, &#123;<span class="number">5</span>&#123;b&#125;&#125;, &#123;<span class="number">5</span>&#123;c&#125;&#125;, &#123;<span class="number">5</span>&#123;d&#125;&#125; ,&#123;<span class="number">5</span>&#123;e&#125;&#125; &#125; ^ &#123; <span class="number">5</span>&#123;a, b, c, d, e&#125; &#125;;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<h3 id="2-3-Modules-Hierarchy"><a href="#2-3-Modules-Hierarchy" class="headerlink" title="2.3 Modules: Hierarchy"></a>2.3 Modules: Hierarchy</h3><p>2.3.1 Modules<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module ( <span class="keyword">input</span> a, <span class="keyword">input</span> b, <span class="keyword">output</span> out );</span><br><span class="line">    mod_a test (<span class="variable">.in1</span>(a), <span class="variable">.in2</span>(b), <span class="variable">.out</span>(out));</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.3.2 connecting ports by position<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module ( </span><br><span class="line">    <span class="keyword">input</span> a, </span><br><span class="line">    <span class="keyword">input</span> b, </span><br><span class="line">    <span class="keyword">input</span> c,</span><br><span class="line">    <span class="keyword">input</span> d,</span><br><span class="line">    <span class="keyword">output</span> out1,</span><br><span class="line">    <span class="keyword">output</span> out2);</span><br><span class="line">    mod_a test(out1, out2, a, b, c, d);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.3.3 connecting ports by name<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module ( </span><br><span class="line">    <span class="keyword">input</span> a, </span><br><span class="line">    <span class="keyword">input</span> b, </span><br><span class="line">    <span class="keyword">input</span> c,</span><br><span class="line">    <span class="keyword">input</span> d,</span><br><span class="line">    <span class="keyword">output</span> out1,</span><br><span class="line">    <span class="keyword">output</span> out2);</span><br><span class="line">    mod_a test (<span class="variable">.in1</span>(a), <span class="variable">.in2</span>(b), <span class="variable">.in3</span>(c), <span class="variable">.in4</span>(d), <span class="variable">.out1</span>(out1), <span class="variable">.out2</span>(out2));</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.3.4 three modules<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module ( <span class="keyword">input</span> clk, <span class="keyword">input</span> d, <span class="keyword">output</span> q );</span><br><span class="line">    <span class="keyword">wire</span> q_1, q_2;</span><br><span class="line">    my_dff my_dff_1(<span class="variable">.clk</span>(clk), <span class="variable">.d</span>(d),   <span class="variable">.q</span>(q_1)); </span><br><span class="line">    my_dff my_dff_2(<span class="variable">.clk</span>(clk), <span class="variable">.d</span>(q_1), <span class="variable">.q</span>(q_2)); </span><br><span class="line">    my_dff my_dff_3(<span class="variable">.clk</span>(clk), <span class="variable">.d</span>(q_2), <span class="variable">.q</span>(q)  ); </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.3.5 modules and vectors<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module ( </span><br><span class="line">    <span class="keyword">input</span> clk, </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] d, </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] sel, </span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] q );</span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] q_1, q_2, q_3;</span><br><span class="line">    <span class="keyword">reg</span>  [<span class="number">7</span>:<span class="number">0</span>] q_out_reg;</span><br><span class="line">    my_dff8 my_dff8_1(<span class="variable">.clk</span>(clk), <span class="variable">.d</span>(d),   <span class="variable">.q</span>(q_1)); </span><br><span class="line">    my_dff8 my_dff8_2(<span class="variable">.clk</span>(clk), <span class="variable">.d</span>(q_1), <span class="variable">.q</span>(q_2)); </span><br><span class="line">    my_dff8 my_dff8_3(<span class="variable">.clk</span>(clk), <span class="variable">.d</span>(q_2), <span class="variable">.q</span>(q_3));   </span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span> (sel)</span><br><span class="line">            <span class="number">2&#x27;d0</span>: q_out_reg = d;</span><br><span class="line">            <span class="number">2&#x27;d1</span>: q_out_reg = q_1;</span><br><span class="line">            <span class="number">2&#x27;d2</span>: q_out_reg = q_2;</span><br><span class="line">            <span class="number">2&#x27;d3</span>: q_out_reg = q_3;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> q = q_out_reg;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.3.6 adder1<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] a,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] b,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">31</span>:<span class="number">0</span>] sum);</span><br><span class="line">    <span class="keyword">wire</span> cout;</span><br><span class="line">    add16 add16_1(<span class="variable">.a</span>(a[<span class="number">15</span>:<span class="number">0</span>]), <span class="variable">.b</span>(b[<span class="number">15</span>:<span class="number">0</span>]), <span class="variable">.cin</span>(<span class="number">1&#x27;b0</span>), <span class="variable">.sum</span>(sum[<span class="number">15</span>:<span class="number">0</span>]), <span class="variable">.cout</span>(cout));</span><br><span class="line">    add16 add16_2(<span class="variable">.a</span>(a[<span class="number">31</span>:<span class="number">16</span>]), <span class="variable">.b</span>(b[<span class="number">31</span>:<span class="number">16</span>]), <span class="variable">.cin</span>(cout), <span class="variable">.sum</span>(sum[<span class="number">31</span>:<span class="number">16</span>]), <span class="variable">.cout</span>());</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.3.7 adder2<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] a,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] b,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">31</span>:<span class="number">0</span>] sum);   </span><br><span class="line">    <span class="keyword">wire</span> cout_1;</span><br><span class="line">    add16 add16_1(<span class="variable">.a</span>(a[<span class="number">15</span>:<span class="number">0</span>]),  <span class="variable">.b</span>(b[<span class="number">15</span>:<span class="number">0</span>]),  <span class="variable">.cin</span>(<span class="number">1&#x27;b0</span>),   <span class="variable">.sum</span>(sum[<span class="number">15</span>:<span class="number">0</span>]),  <span class="variable">.cout</span>(cout_1));</span><br><span class="line">    add16 add16_2(<span class="variable">.a</span>(a[<span class="number">31</span>:<span class="number">16</span>]), <span class="variable">.b</span>(b[<span class="number">31</span>:<span class="number">16</span>]), <span class="variable">.cin</span>(cout_1), <span class="variable">.sum</span>(sum[<span class="number">31</span>:<span class="number">16</span>]), <span class="variable">.cout</span>());</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> add1 ( <span class="keyword">input</span> a, <span class="keyword">input</span> b, <span class="keyword">input</span> cin,   <span class="keyword">output</span> sum, <span class="keyword">output</span> cout );</span><br><span class="line">	<span class="keyword">assign</span> &#123;cout, sum&#125; = a + b + cin;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.3.8 carry-select adder<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] a,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] b,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">31</span>:<span class="number">0</span>] sum);</span><br><span class="line">    <span class="keyword">wire</span> cout;</span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] sum_1,sum_2;</span><br><span class="line">    add16 add16_1(<span class="variable">.a</span>(a[<span class="number">15</span>:<span class="number">0</span>]), <span class="variable">.b</span>(b[<span class="number">15</span>:<span class="number">0</span>]), <span class="variable">.cin</span>(<span class="number">1&#x27;b0</span>), <span class="variable">.sum</span>(sum[<span class="number">15</span>:<span class="number">0</span>]), <span class="variable">.cout</span>(cout));</span><br><span class="line">    add16 add16_2(<span class="variable">.a</span>(a[<span class="number">31</span>:<span class="number">16</span>]), <span class="variable">.b</span>(b[<span class="number">31</span>:<span class="number">16</span>]), <span class="variable">.cin</span>(<span class="number">1&#x27;b0</span>), <span class="variable">.sum</span>(sum_1), <span class="variable">.cout</span>());</span><br><span class="line">    add16 add16_3(<span class="variable">.a</span>(a[<span class="number">31</span>:<span class="number">16</span>]), <span class="variable">.b</span>(b[<span class="number">31</span>:<span class="number">16</span>]), <span class="variable">.cin</span>(<span class="number">1&#x27;b1</span>), <span class="variable">.sum</span>(sum_2), <span class="variable">.cout</span>());</span><br><span class="line">    <span class="keyword">assign</span> sum[<span class="number">31</span>:<span class="number">16</span>] = cout ? sum_2 : sum_1; </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.3.9 adder-subtractor<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] a,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] b,</span><br><span class="line">    <span class="keyword">input</span> sub,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">31</span>:<span class="number">0</span>] sum);</span><br><span class="line">    <span class="keyword">wire</span> cout;</span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] b_1;</span><br><span class="line">    <span class="keyword">assign</span> b_1 = b ^ &#123;<span class="number">32</span>&#123;sub&#125;&#125;;</span><br><span class="line">    add16 add16_1(<span class="variable">.a</span>(a[<span class="number">15</span>:<span class="number">0</span>]), <span class="variable">.b</span>(b_1[<span class="number">15</span>:<span class="number">0</span>]), <span class="variable">.cin</span>(sub), <span class="variable">.sum</span>(sum[<span class="number">15</span>:<span class="number">0</span>]), <span class="variable">.cout</span>(cout));</span><br><span class="line">    add16 add16_2(<span class="variable">.a</span>(a[<span class="number">31</span>:<span class="number">16</span>]), <span class="variable">.b</span>(b_1[<span class="number">31</span>:<span class="number">16</span>]), <span class="variable">.cin</span>(cout), <span class="variable">.sum</span>(sum[<span class="number">31</span>:<span class="number">16</span>]), <span class="variable">.cout</span>());</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<h3 id="2-4-Procedures"><a href="#2-4-Procedures" class="headerlink" title="2.4 Procedures"></a>2.4 Procedures</h3><p>2.4.1 always blocks 1<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// synthesis verilog_input_version verilog_2001</span></span><br><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> a, </span><br><span class="line">    <span class="keyword">input</span> b,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> out_assign,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> out_alwaysbloc);</span><br><span class="line">	<span class="keyword">assign</span> out_assign = a &amp; b;</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        out_alwaysblock = a &amp; b;</span><br><span class="line">    <span class="keyword">end</span> </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.4.2 always blocks 2<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// synthesis verilog_input_version verilog_2001</span></span><br><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">input</span> b,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> out_assign,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> out_always_comb,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> out_always_ff   );  </span><br><span class="line">	<span class="keyword">assign</span> out_assign = a ^ b;</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        out_always_comb = a ^ b;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        out_always_ff &lt;= a ^ b;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.4.3 if statement<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// synthesis verilog_input_version verilog_2001</span></span><br><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">input</span> b,</span><br><span class="line">    <span class="keyword">input</span> sel_b1,</span><br><span class="line">    <span class="keyword">input</span> sel_b2,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> out_assign,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> out_always   ); </span><br><span class="line">    <span class="keyword">assign</span> out_assign = (sel_b1 &amp; sel_b2) ? b : a;</span><br><span class="line">    <span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(sel_b1 &amp; sel_b2)</span><br><span class="line">            out_always = b;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            out_always = a;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.4.3 if statement latches<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// synthesis verilog_input_version verilog_2001</span></span><br><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span>      cpu_overheated,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> shut_off_computer,</span><br><span class="line">    <span class="keyword">input</span>      arrived,</span><br><span class="line">    <span class="keyword">input</span>      gas_tank_empty,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> keep_driving  ); </span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (cpu_overheated)</span><br><span class="line">           shut_off_computer = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">           shut_off_computer = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (~arrived)</span><br><span class="line">           keep_driving = ~gas_tank_empty;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">           keep_driving = ~arrived;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.4.4 case statement<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// synthesis verilog_input_version verilog_2001</span></span><br><span class="line"><span class="keyword">module</span> top_module ( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">2</span>:<span class="number">0</span>] sel, </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] data0,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] data1,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] data2,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] data3,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] data4,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] data5,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] out   );</span><br><span class="line">    <span class="keyword">always</span>@(*) <span class="keyword">begin</span>  <span class="comment">// This is a combinational circuit</span></span><br><span class="line">        <span class="keyword">case</span>(sel)</span><br><span class="line">            <span class="number">3&#x27;d0</span>: out = data0;</span><br><span class="line">            <span class="number">3&#x27;d1</span>: out = data1;</span><br><span class="line">            <span class="number">3&#x27;d2</span>: out = data2;</span><br><span class="line">            <span class="number">3&#x27;d3</span>: out = data3;</span><br><span class="line">            <span class="number">3&#x27;d4</span>: out = data4;</span><br><span class="line">            <span class="number">3&#x27;d5</span>: out = data5;</span><br><span class="line">            <span class="keyword">default</span>: out = <span class="number">4&#x27;d0</span>;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.4.5 priority encoder<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// synthesis verilog_input_version verilog_2001</span></span><br><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] pos  );</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span> (in)</span><br><span class="line">            <span class="number">4&#x27;b0000</span>: pos = <span class="number">2&#x27;d0</span>;</span><br><span class="line">            <span class="number">4&#x27;b0001</span>, <span class="number">4&#x27;b0011</span>, <span class="number">4&#x27;b0101</span>, <span class="number">4&#x27;b0111</span>, <span class="number">4&#x27;b1001</span>, <span class="number">4&#x27;b1011</span>, <span class="number">4&#x27;b1101</span>, <span class="number">4&#x27;b1111</span>: pos = <span class="number">2&#x27;d0</span>;</span><br><span class="line">            <span class="number">4&#x27;b0010</span>, <span class="number">4&#x27;b0110</span>, <span class="number">4&#x27;b1010</span>, <span class="number">4&#x27;b1110</span>: pos = <span class="number">2&#x27;d1</span>;</span><br><span class="line">            <span class="number">4&#x27;b0100</span>, <span class="number">4&#x27;b1100</span>: pos = <span class="number">2&#x27;d2</span>;</span><br><span class="line">            <span class="number">4&#x27;b1000</span>: pos = <span class="number">2&#x27;d3</span>;</span><br><span class="line">            <span class="keyword">default</span>: pos = <span class="number">2&#x27;d0</span>;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.4.6 priority encoder with casez</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// synthesis verilog_input_version verilog_2001</span></span><br><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] pos  );</span><br><span class="line">    <span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">    	<span class="keyword">casez</span> (in[<span class="number">7</span>:<span class="number">0</span>])</span><br><span class="line">        	<span class="number">8&#x27;bzzzzzzz1</span>: pos = <span class="number">3&#x27;d0</span>;   </span><br><span class="line">        	<span class="number">8&#x27;bzzzzzz1z</span>: pos = <span class="number">3&#x27;d1</span>;</span><br><span class="line">        	<span class="number">8&#x27;bzzzzz1zz</span>: pos = <span class="number">3&#x27;d2</span>;</span><br><span class="line">        	<span class="number">8&#x27;bzzzz1zzz</span>: pos = <span class="number">3&#x27;d3</span>;</span><br><span class="line">        	<span class="number">8&#x27;bzzz1zzzz</span>: pos = <span class="number">3&#x27;d4</span>;</span><br><span class="line">        	<span class="number">8&#x27;bzz1zzzzz</span>: pos = <span class="number">3&#x27;d5</span>;</span><br><span class="line">        	<span class="number">8&#x27;bz1zzzzzz</span>: pos = <span class="number">3&#x27;d6</span>;</span><br><span class="line">        	<span class="number">8&#x27;b1zzzzzzz</span>: pos = <span class="number">3&#x27;d7</span>;</span><br><span class="line">        	<span class="keyword">default</span>: pos = <span class="number">3&#x27;d0</span>;</span><br><span class="line">    	<span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>2.4.7 avoiding latches<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// synthesis verilog_input_version verilog_2001</span></span><br><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">15</span>:<span class="number">0</span>] scancode,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> left,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> down,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> right,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> up  ); </span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span> (scancode)</span><br><span class="line">            <span class="number">16&#x27;he06b</span>: <span class="keyword">begin</span> left = <span class="number">1</span>; down = <span class="number">0</span>; right = <span class="number">0</span>; up = <span class="number">0</span>; <span class="keyword">end</span>       </span><br><span class="line">            <span class="number">16&#x27;he072</span>: <span class="keyword">begin</span> left = <span class="number">0</span>; down = <span class="number">1</span>; right = <span class="number">0</span>; up = <span class="number">0</span>; <span class="keyword">end</span></span><br><span class="line">            <span class="number">16&#x27;he074</span>: <span class="keyword">begin</span> left = <span class="number">0</span>; down = <span class="number">0</span>; right = <span class="number">1</span>; up = <span class="number">0</span>; <span class="keyword">end</span>           </span><br><span class="line">            <span class="number">16&#x27;he075</span>: <span class="keyword">begin</span> left = <span class="number">0</span>; down = <span class="number">0</span>; right = <span class="number">0</span>; up = <span class="number">1</span>; <span class="keyword">end</span>            </span><br><span class="line">            <span class="keyword">default</span>: <span class="keyword">begin</span>  left = <span class="number">0</span>; down = <span class="number">0</span>; right = <span class="number">0</span>; up = <span class="number">0</span>; <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<h3 id="2-5-More-Verilog-Features"><a href="#2-5-More-Verilog-Features" class="headerlink" title="2.5 More Verilog Features"></a>2.5 More Verilog Features</h3><p>2.5.1 conditional ternary operator<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] a, b, c, d,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] min); </span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] min_1, min_2;</span><br><span class="line">    <span class="keyword">assign</span> min_1 = (a &lt; b) ? a : b;</span><br><span class="line">    <span class="keyword">assign</span> min_2 = (c &lt; d) ? c : d;</span><br><span class="line">    <span class="keyword">assign</span> min   = (min_1 &lt; min_2) ? min_1 : min_2;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.5.2 reduction operators<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> parity);</span><br><span class="line">    <span class="keyword">assign</span> parity = ^in;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.5.3 reduction : even wider gates<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">99</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> out_and,</span><br><span class="line">    <span class="keyword">output</span> out_or,</span><br><span class="line">    <span class="keyword">output</span> out_xor );</span><br><span class="line">	<span class="keyword">assign</span> out_and = &amp; in;</span><br><span class="line">    <span class="keyword">assign</span> out_or  = | in;</span><br><span class="line">    <span class="keyword">assign</span> out_xor = ^ in;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.5.4 combinational for-loop vector reversal 2</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">99</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">99</span>:<span class="number">0</span>] out);</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">6</span>:<span class="number">0</span>] i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i = i + <span class="number">1</span>)<span class="keyword">begin</span></span><br><span class="line">            out[i] = in[<span class="number">99</span> - i];</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>2.5.5 combinational for-loop: 255-bit population count<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">254</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] out );</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] i;</span><br><span class="line">    <span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">     	out = <span class="number">8&#x27;d0</span>;</span><br><span class="line">    	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">255</span>; i = i + <span class="number">1</span>)</span><br><span class="line">        	<span class="keyword">if</span> (in[i])</span><br><span class="line">            	out = out + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            out = out;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<p>2.5.6 generate for-loop: 100-bit binary adder 2<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">99</span>:<span class="number">0</span>] a, b,</span><br><span class="line">    <span class="keyword">input</span> cin,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">99</span>:<span class="number">0</span>] cout,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">99</span>:<span class="number">0</span>] sum );</span><br><span class="line">    <span class="keyword">assign</span> cout[<span class="number">0</span>] = a[<span class="number">0</span>] &amp; b[<span class="number">0</span>] | a[<span class="number">0</span>] &amp; cin | b[<span class="number">0</span>] &amp; cin;</span><br><span class="line">    <span class="keyword">assign</span> sum[<span class="number">0</span>]  = a[<span class="number">0</span>] ^ b[<span class="number">0</span>] ^ cin;</span><br><span class="line">    <span class="keyword">genvar</span> i;</span><br><span class="line">    <span class="keyword">generate</span></span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">1</span>; i&lt;<span class="number">100</span>; i++) <span class="keyword">begin</span> : adder_loop</span><br><span class="line">            <span class="keyword">assign</span> cout[i] = a[i] &amp; b[i] | a[i] &amp; cout[i-<span class="number">1</span>] | b[i] &amp; cout[i-<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">assign</span> sum[i]  = a[i] ^ b[i] ^ cout[i-<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">endgenerate</span>  </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2.5.7  generate for-loop: 100-bit digit BCD adder 2</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">399</span>:<span class="number">0</span>] a, b,</span><br><span class="line">    <span class="keyword">input</span> cin,</span><br><span class="line">    <span class="keyword">output</span> cout,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">399</span>:<span class="number">0</span>] sum );</span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">399</span>:<span class="number">0</span>] cout_temp;</span><br><span class="line">    bcd_fadd u1(<span class="variable">.a</span>(a[<span class="number">3</span>:<span class="number">0</span>]), <span class="variable">.b</span>(b[<span class="number">3</span>:<span class="number">0</span>]), <span class="variable">.cin</span>(cin), <span class="variable">.cout</span>(cout_temp[<span class="number">0</span>]), <span class="variable">.sum</span>(sum[<span class="number">3</span>:<span class="number">0</span>]));</span><br><span class="line">    <span class="keyword">assign</span> cout = cout_temp[<span class="number">396</span>];</span><br><span class="line">    <span class="keyword">genvar</span> i;</span><br><span class="line">    <span class="keyword">generate</span></span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">4</span>; i &lt; <span class="number">400</span>; i = i + <span class="number">4</span>) <span class="keyword">begin</span> : adder_loop</span><br><span class="line">            bcd_fadd u1(<span class="variable">.a</span>(a[i+<span class="number">3</span>:i]), <span class="variable">.b</span>(b[i+<span class="number">3</span>:i]), <span class="variable">.cin</span>(cout_temp[i-<span class="number">4</span>]), <span class="variable">.cout</span>(cout_temp[i]), <span class="variable">.sum</span>(sum[i+<span class="number">3</span>:i]));</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">endgenerate</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h2 id="3-Circuits"><a href="#3-Circuits" class="headerlink" title="3 Circuits"></a>3 Circuits</h2><h3 id="3-1-Combinational-Logic"><a href="#3-1-Combinational-Logic" class="headerlink" title="3.1 Combinational Logic"></a>3.1 Combinational Logic</h3><h4 id="3-1-1-Basic-Gates"><a href="#3-1-1-Basic-Gates" class="headerlink" title="3.1.1 Basic Gates"></a>3.1.1 Basic Gates</h4><p>1 wire<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> in,</span><br><span class="line">    <span class="keyword">output</span> out);</span><br><span class="line">    <span class="keyword">assign</span> out = in;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<p>2 GND<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">output</span> out);</span><br><span class="line"> 	<span class="keyword">assign</span> out = <span class="number">1&#x27;b0</span>;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>3 NOR<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> in1,</span><br><span class="line">    <span class="keyword">input</span> in2,</span><br><span class="line">    <span class="keyword">output</span> out);</span><br><span class="line">    <span class="keyword">assign</span> out = ~(in1 | in2);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>4 another gate</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> in1,</span><br><span class="line">    <span class="keyword">input</span> in2,</span><br><span class="line">    <span class="keyword">output</span> out);</span><br><span class="line">    <span class="keyword">assign</span> out = in1 &amp; (~in2);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>5 two gate</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> in1,</span><br><span class="line">    <span class="keyword">input</span> in2,</span><br><span class="line">    <span class="keyword">input</span> in3,</span><br><span class="line">    <span class="keyword">output</span> out);</span><br><span class="line">    <span class="keyword">assign</span> out = (in1 ^~ in2) ^ in3;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>6 more logic gates<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> a, b,</span><br><span class="line">    <span class="keyword">output</span> out_and,</span><br><span class="line">    <span class="keyword">output</span> out_or,</span><br><span class="line">    <span class="keyword">output</span> out_xor,</span><br><span class="line">    <span class="keyword">output</span> out_nand,</span><br><span class="line">    <span class="keyword">output</span> out_nor,</span><br><span class="line">    <span class="keyword">output</span> out_xnor,</span><br><span class="line">    <span class="keyword">output</span> out_anotb );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> out_and  = a &amp; b;</span><br><span class="line">    <span class="keyword">assign</span> out_or   = a | b;</span><br><span class="line">    <span class="keyword">assign</span> out_xor  = a ^ b;</span><br><span class="line">    <span class="keyword">assign</span> out_nand = ~(a &amp; b);</span><br><span class="line">    <span class="keyword">assign</span> out_nor  = ~(a | b);</span><br><span class="line">    <span class="keyword">assign</span> out_xnor = a ^~ b;</span><br><span class="line">    <span class="keyword">assign</span> out_anotb = a &amp; (~b);</span><br><span class="line">   </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>7 7420 chip<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module ( </span><br><span class="line">    <span class="keyword">input</span> p1a, p1b, p1c, p1d,</span><br><span class="line">    <span class="keyword">output</span> p1y,</span><br><span class="line">    <span class="keyword">input</span> p2a, p2b, p2c, p2d,</span><br><span class="line">    <span class="keyword">output</span> p2y );</span><br><span class="line">    <span class="keyword">assign</span> p1y = ~(p1a &amp; p1b &amp; p1c &amp; p1d);</span><br><span class="line">    <span class="keyword">assign</span> p2y = ~(p2a &amp; p2b &amp; p2c &amp; p2d);</span><br><span class="line">    </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>8 truth table<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> x3,</span><br><span class="line">    <span class="keyword">input</span> x2,</span><br><span class="line">    <span class="keyword">input</span> x1, </span><br><span class="line">    <span class="keyword">output</span> f  );</span><br><span class="line">    <span class="keyword">assign</span> f = ((~x3) &amp; x2 &amp; (~x1)) | ((~x3) &amp; x2 &amp; x1) | (x3 &amp; (~x2) &amp; x1) | (x3 &amp; x2 &amp; x1);	</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>9 two-bits equality</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module ( <span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] A, <span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] B, <span class="keyword">output</span> z ); </span><br><span class="line">    <span class="keyword">assign</span> z = (A == B) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>10 sample circuits A<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (<span class="keyword">input</span> x, <span class="keyword">input</span> y, <span class="keyword">output</span> z);</span><br><span class="line">    <span class="keyword">assign</span> z= (x ^ y) &amp; x;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>11 sample circuits B<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module ( <span class="keyword">input</span> x, <span class="keyword">input</span> y, <span class="keyword">output</span> z );</span><br><span class="line">	<span class="keyword">assign</span> z = x ^~ y;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>12 combine circuits A and B<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (<span class="keyword">input</span> x, <span class="keyword">input</span> y, <span class="keyword">output</span> z);</span><br><span class="line">    <span class="keyword">wire</span> z1,z2;</span><br><span class="line">	<span class="keyword">assign</span> z1= (x ^ y) &amp; x;</span><br><span class="line">	<span class="keyword">assign</span> z2 = x ^~ y;</span><br><span class="line">    <span class="keyword">assign</span> z = (z1 | z2) ^ (z1 &amp; z2);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>13 ring or vibrate<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> ring,</span><br><span class="line">    <span class="keyword">input</span> vibrate_mode,</span><br><span class="line">    <span class="keyword">output</span> ringer,     </span><br><span class="line">    <span class="keyword">output</span> motor       );</span><br><span class="line">    <span class="keyword">assign</span> &#123;ringer, motor&#125; = ring ? (vibrate_mode ? <span class="number">2&#x27;b01</span> : <span class="number">2&#x27;b10</span>) : <span class="number">2&#x27;b00</span>;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>14 thermostat<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> too_cold,</span><br><span class="line">    <span class="keyword">input</span> too_hot,</span><br><span class="line">    <span class="keyword">input</span> mode,</span><br><span class="line">    <span class="keyword">input</span> fan_on,</span><br><span class="line">    <span class="keyword">output</span> heater,</span><br><span class="line">    <span class="keyword">output</span> aircon,</span><br><span class="line">    <span class="keyword">output</span> fan    ); </span><br><span class="line">    <span class="keyword">assign</span> heater = mode ? (too_cold ? <span class="number">1&#x27;b1</span> : <span class="number">1&#x27;b0</span>) : <span class="number">1&#x27;b0</span>;</span><br><span class="line">    <span class="keyword">assign</span> aircon = ~mode ? (too_hot ? <span class="number">1&#x27;b1</span> : <span class="number">1&#x27;b0</span>) : <span class="number">1&#x27;b0</span>;</span><br><span class="line">    <span class="keyword">assign</span> fan = heater | aircon | fan_on;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>15 3-bit population count<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">2</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">1</span>:<span class="number">0</span>] out );</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] i;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        out = <span class="number">2&#x27;d0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i = i + <span class="number">1&#x27;b1</span>)</span><br><span class="line">            <span class="keyword">if</span> (in[i] == <span class="number">1</span>)</span><br><span class="line">                out = out + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        	<span class="keyword">else</span></span><br><span class="line">            	out = out;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>16 gates and vectors<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">2</span>:<span class="number">0</span>] out_both,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">1</span>] out_any,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] out_different );</span><br><span class="line">    <span class="keyword">assign</span> &#123;out_both[<span class="number">2</span>], out_both[<span class="number">1</span>], out_both[<span class="number">0</span>]&#125; = &#123;in[<span class="number">3</span>] &amp; in[<span class="number">2</span>], in[<span class="number">2</span>] &amp; in[<span class="number">1</span>], in[<span class="number">1</span>] &amp; in[<span class="number">0</span>]&#125;;</span><br><span class="line">    <span class="keyword">assign</span> &#123;out_any[<span class="number">3</span>],  out_any[<span class="number">2</span>],  out_any[<span class="number">1</span>]&#125;  = &#123;in[<span class="number">3</span>] | in[<span class="number">2</span>], in[<span class="number">2</span>] | in[<span class="number">1</span>], in[<span class="number">1</span>] | in[<span class="number">0</span>]&#125;;</span><br><span class="line">    <span class="keyword">assign</span> &#123;out_different[<span class="number">3</span>], out_different[<span class="number">2</span>], out_different[<span class="number">1</span>], out_different[<span class="number">0</span>]&#125; = &#123;in[<span class="number">0</span>] ^ in[<span class="number">3</span>], in[<span class="number">3</span>] ^ in[<span class="number">2</span>], in[<span class="number">2</span>] ^ in[<span class="number">1</span>], in[<span class="number">1</span>] ^ in[<span class="number">0</span>]&#125;;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>17 Even longer vectors</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">99</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">98</span>:<span class="number">0</span>] out_both,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">99</span>:<span class="number">1</span>] out_any,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">99</span>:<span class="number">0</span>] out_different );</span><br><span class="line">    <span class="keyword">assign</span> out_both = in[<span class="number">99</span>:<span class="number">1</span>] &amp; in[<span class="number">98</span>:<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">assign</span> out_any  = in[<span class="number">99</span>:<span class="number">1</span>] | in[<span class="number">98</span>:<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">assign</span> out_different = in[<span class="number">99</span>:<span class="number">0</span>] ^ &#123;in[<span class="number">0</span>], in[<span class="number">99</span>:<span class="number">1</span>]&#125;;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h4 id="3-1-2-Multiplexers"><a href="#3-1-2-Multiplexers" class="headerlink" title="3.1.2 Multiplexers"></a>3.1.2 Multiplexers</h4><p>1 2 to 1 multiplexers<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> a, b, sel,</span><br><span class="line">    <span class="keyword">output</span> out ); </span><br><span class="line">    <span class="keyword">assign</span> out = sel ? b : a;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2 2 to 1 bus multiplexers<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">99</span>:<span class="number">0</span>] a, b,</span><br><span class="line">    <span class="keyword">input</span> sel,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">99</span>:<span class="number">0</span>] out );</span><br><span class="line">    <span class="keyword">assign</span> out = sel ? b : a;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>3 9 to 1 multiplexers<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">15</span>:<span class="number">0</span>] a, b, c, d, e, f, g, h, i,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] sel,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">15</span>:<span class="number">0</span>] out );</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span> (sel)</span><br><span class="line">            <span class="number">4&#x27;d0</span>: out = a;</span><br><span class="line">            <span class="number">4&#x27;d1</span>: out = b;</span><br><span class="line">            <span class="number">4&#x27;d2</span>: out = c;</span><br><span class="line">            <span class="number">4&#x27;d3</span>: out = d;</span><br><span class="line">            <span class="number">4&#x27;d4</span>: out = e;</span><br><span class="line">            <span class="number">4&#x27;d5</span>: out = f;</span><br><span class="line">            <span class="number">4&#x27;d6</span>: out = g;</span><br><span class="line">            <span class="number">4&#x27;d7</span>: out = h;</span><br><span class="line">            <span class="number">4&#x27;d8</span>: out = i;</span><br><span class="line">            <span class="keyword">default</span>: out = <span class="number">16&#x27;hffff</span>;            </span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>4 256 to 1 multiplexers<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">255</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] sel,</span><br><span class="line">    <span class="keyword">output</span> out );</span><br><span class="line">    <span class="keyword">assign</span> out = in[sel];</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>5 256 to 1 4-bit multiplexers<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">1023</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] sel,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] out );</span><br><span class="line">    <span class="keyword">assign</span> out = &#123;in[sel*<span class="number">4</span>+<span class="number">3</span>], in[sel*<span class="number">4</span>+<span class="number">2</span>], in[sel*<span class="number">4</span>+<span class="number">1</span>], in[sel*<span class="number">4</span>]&#125;;		</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<h4 id="3-1-3-Arithmetic-Circuits"><a href="#3-1-3-Arithmetic-Circuits" class="headerlink" title="3.1.3 Arithmetic Circuits"></a>3.1.3 Arithmetic Circuits</h4><p>1 half adder<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> a, b,</span><br><span class="line">    <span class="keyword">output</span> cout, sum );</span><br><span class="line">    <span class="keyword">assign</span> &#123;cout,sum&#125; = a + b;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2 full adder<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> a, b, cin,</span><br><span class="line">    <span class="keyword">output</span> cout, sum );</span><br><span class="line">    <span class="keyword">assign</span> &#123;cout,sum&#125; = a + b + cin;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2 3-bit binary adder</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">2</span>:<span class="number">0</span>] a, b,</span><br><span class="line">    <span class="keyword">input</span> cin,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">2</span>:<span class="number">0</span>] cout,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">2</span>:<span class="number">0</span>] sum );</span><br><span class="line">    adder adder_1(<span class="variable">.a</span>(a[<span class="number">0</span>]), <span class="variable">.b</span>(b[<span class="number">0</span>]), <span class="variable">.cin</span>(cin), <span class="variable">.cout</span>(cout[<span class="number">0</span>]), <span class="variable">.sum</span>(sum[<span class="number">0</span>]));    </span><br><span class="line">    adder adder_2(<span class="variable">.a</span>(a[<span class="number">1</span>]), <span class="variable">.b</span>(b[<span class="number">1</span>]), <span class="variable">.cin</span>(cout[<span class="number">0</span>]), <span class="variable">.cout</span>(cout[<span class="number">1</span>]), <span class="variable">.sum</span>(sum[<span class="number">1</span>]));</span><br><span class="line">    adder adder_3(<span class="variable">.a</span>(a[<span class="number">2</span>]), <span class="variable">.b</span>(b[<span class="number">2</span>]), <span class="variable">.cin</span>(cout[<span class="number">1</span>]), <span class="variable">.cout</span>(cout[<span class="number">2</span>]), <span class="variable">.sum</span>(sum[<span class="number">2</span>]));</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"><span class="comment">//全加器</span></span><br><span class="line"><span class="keyword">module</span> adder( </span><br><span class="line">    <span class="keyword">input</span> a, b, cin,</span><br><span class="line">    <span class="keyword">output</span> cout, sum );</span><br><span class="line">    <span class="keyword">assign</span> &#123;cout,sum&#125; = a + b + cin;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>4 adder<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] x,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] y, </span><br><span class="line">    <span class="keyword">output</span> [<span class="number">4</span>:<span class="number">0</span>] sum);</span><br><span class="line">    <span class="keyword">wire</span> cout_1,cout_2,cout_3;</span><br><span class="line">    <span class="keyword">assign</span> sum = x + y;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>5 signed addition overflow<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] a,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] b,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] s,</span><br><span class="line">    <span class="keyword">output</span> overflow); </span><br><span class="line">    <span class="keyword">assign</span> s = a + b;</span><br><span class="line">    <span class="keyword">assign</span> overflow = a[<span class="number">7</span>] == b[<span class="number">7</span>] &amp; ( a[<span class="number">7</span>] != s[<span class="number">7</span>] | b[<span class="number">7</span>] != s[<span class="number">7</span>]);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>6 100-bit binary adder<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">99</span>:<span class="number">0</span>] a, b,</span><br><span class="line">    <span class="keyword">input</span> cin,</span><br><span class="line">    <span class="keyword">output</span> cout,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">99</span>:<span class="number">0</span>] sum );</span><br><span class="line">    <span class="keyword">assign</span> &#123;cout, sum&#125; = a + b + cin;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>7 4- digit BCD adder<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module( </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">15</span>:<span class="number">0</span>] a, b,</span><br><span class="line">    <span class="keyword">input</span> cin,</span><br><span class="line">    <span class="keyword">output</span> cout,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">15</span>:<span class="number">0</span>] sum );</span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">2</span>:<span class="number">0</span>] cout_temp;</span><br><span class="line">    bcd_fadd bcd_fadd_0(<span class="variable">.a</span>(a[<span class="number">3</span>:<span class="number">0</span>]),   <span class="variable">.b</span>(b[<span class="number">3</span>:<span class="number">0</span>]),   <span class="variable">.cin</span>(cin),          <span class="variable">.cout</span>(cout_temp[<span class="number">0</span>]), <span class="variable">.sum</span>(sum[<span class="number">3</span>:<span class="number">0</span>]));</span><br><span class="line">    bcd_fadd bcd_fadd_1(<span class="variable">.a</span>(a[<span class="number">7</span>:<span class="number">4</span>]),   <span class="variable">.b</span>(b[<span class="number">7</span>:<span class="number">4</span>]),   <span class="variable">.cin</span>(cout_temp[<span class="number">0</span>]), <span class="variable">.cout</span>(cout_temp[<span class="number">1</span>]), <span class="variable">.sum</span>(sum[<span class="number">7</span>:<span class="number">4</span>]));</span><br><span class="line">    bcd_fadd bcd_fadd_2(<span class="variable">.a</span>(a[<span class="number">11</span>:<span class="number">8</span>]),  <span class="variable">.b</span>(b[<span class="number">11</span>:<span class="number">8</span>]),  <span class="variable">.cin</span>(cout_temp[<span class="number">1</span>]), <span class="variable">.cout</span>(cout_temp[<span class="number">2</span>]), <span class="variable">.sum</span>(sum[<span class="number">11</span>:<span class="number">8</span>]));</span><br><span class="line">    bcd_fadd bcd_fadd_3(<span class="variable">.a</span>(a[<span class="number">15</span>:<span class="number">12</span>]), <span class="variable">.b</span>(b[<span class="number">15</span>:<span class="number">12</span>]), <span class="variable">.cin</span>(cout_temp[<span class="number">2</span>]), <span class="variable">.cout</span>(cout),         <span class="variable">.sum</span>(sum[<span class="number">15</span>:<span class="number">12</span>]));</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<h4 id="3-1-4-Karnaugh-Map-to-Circuit"><a href="#3-1-4-Karnaugh-Map-to-Circuit" class="headerlink" title="3.1.4 Karnaugh Map to Circuit"></a>3.1.4 Karnaugh Map to Circuit</h4><p>1 3-variable<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">input</span> b,</span><br><span class="line">    <span class="keyword">input</span> c,</span><br><span class="line">    <span class="keyword">output</span> out  ); </span><br><span class="line">    <span class="keyword">assign</span> out = a | ((~a) &amp; c) | (b &amp; (~c));</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2 4-variable 1<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">input</span> b,</span><br><span class="line">    <span class="keyword">input</span> c,</span><br><span class="line">    <span class="keyword">input</span> d,</span><br><span class="line">    <span class="keyword">output</span> out  ); </span><br><span class="line">    <span class="keyword">assign</span> out = ((~b) &amp; (~c)) | ((~a) &amp; (~d)) | (b&amp;c&amp;d) | (a&amp;c&amp;d);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>3 4-variable 2<br> <figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">input</span> b,</span><br><span class="line">    <span class="keyword">input</span> c,</span><br><span class="line">    <span class="keyword">input</span> d,</span><br><span class="line">    <span class="keyword">output</span> out  ); </span><br><span class="line">    <span class="keyword">assign</span> out = a | ((~a) &amp; (~b) &amp; (c));</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>4 4-variable 3<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">input</span> b,</span><br><span class="line">    <span class="keyword">input</span> c,</span><br><span class="line">    <span class="keyword">input</span> d,</span><br><span class="line">    <span class="keyword">output</span> out  ); </span><br><span class="line">	<span class="keyword">assign</span> out = ~a&amp;~b&amp;~c&amp;d | ~a&amp;~b&amp;c&amp;~d | ~a&amp;b&amp;~c&amp;~d | ~a&amp;b&amp;c&amp;d | a&amp;b&amp;~c&amp;d | a&amp;b&amp;c&amp;~d | a&amp;~b&amp;~c&amp;~d | a&amp;~b&amp;c&amp;d;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>5 minimum SOP and POS<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">input</span> b,</span><br><span class="line">    <span class="keyword">input</span> c,</span><br><span class="line">    <span class="keyword">input</span> d,</span><br><span class="line">    <span class="keyword">output</span> out_sop,</span><br><span class="line">    <span class="keyword">output</span> out_pos); </span><br><span class="line">    <span class="keyword">assign</span> out_sop = (c &amp; d) | (~a &amp; c &amp; ~b);</span><br><span class="line">    <span class="keyword">assign</span> out_pos = c &amp; (~b | d) &amp; (~a | d);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>6 Karnaugh map<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">4</span>:<span class="number">1</span>] x, </span><br><span class="line">    <span class="keyword">output</span> f );</span><br><span class="line">    <span class="keyword">assign</span> f = (x[<span class="number">3</span>] &amp; ~x[<span class="number">1</span>]) | (~x[<span class="number">3</span>] &amp; x[<span class="number">1</span>] &amp; x[<span class="number">2</span>]);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>7 Karnaugh map</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">4</span>:<span class="number">1</span>] x,</span><br><span class="line">    <span class="keyword">output</span> f); </span><br><span class="line">    <span class="keyword">assign</span> f = (x[<span class="number">3</span>] &amp; ~x[<span class="number">1</span>]) | (~x[<span class="number">4</span>] &amp; ~x[<span class="number">2</span>]) | ( x[<span class="number">2</span>] &amp; x[<span class="number">3</span>] &amp; x[<span class="number">4</span>]);  </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>8 K-map implemented with a multiplexer<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> c,</span><br><span class="line">    <span class="keyword">input</span> d,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] mux_in); </span><br><span class="line">    <span class="keyword">assign</span> mux_in[<span class="number">0</span>] = (c | d) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">assign</span> mux_in[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">assign</span> mux_in[<span class="number">2</span>] =  (~d) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">assign</span> mux_in[<span class="number">3</span>] = (c &amp; d) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<h3 id="3-2-sequential-Logic"><a href="#3-2-sequential-Logic" class="headerlink" title="3.2 sequential Logic"></a>3.2 sequential Logic</h3><h4 id="3-2-1-latches-and-Flip-Flops"><a href="#3-2-1-latches-and-Flip-Flops" class="headerlink" title="3.2.1 latches and Flip-Flops"></a>3.2.1 latches and Flip-Flops</h4><p>1 DFF<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,    <span class="comment">// Clocks are used in sequential circuits</span></span><br><span class="line">    <span class="keyword">input</span> d,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> q );<span class="comment">//</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        q &lt;= d;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2 DFF<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] d,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    	q &lt;= d;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>3 DFF with reset<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,            <span class="comment">// Synchronous reset</span></span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] d,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)</span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        	q &lt;= d;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>4 DFF with reset value<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] d,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] q );</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">negedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)</span><br><span class="line">            q &lt;= <span class="number">8&#x27;h34</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        	q &lt;= d;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>5 DFF with asynchronous reset<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> areset,   <span class="comment">// active high asynchronous reset</span></span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] d,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">posedge</span> areset) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(areset)</span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        	q &lt;= d;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>6 DFF with byte enable<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> resetn,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] byteena,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">15</span>:<span class="number">0</span>] d,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">15</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(!resetn)</span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span>(byteena[<span class="number">1</span>])</span><br><span class="line">               q[<span class="number">15</span>:<span class="number">8</span>] &lt;= d[<span class="number">15</span>:<span class="number">8</span>]; </span><br><span class="line">        	<span class="keyword">else</span></span><br><span class="line">               q[<span class="number">15</span>:<span class="number">8</span>] &lt;= q[<span class="number">15</span>:<span class="number">8</span>];</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(byteena[<span class="number">0</span>])</span><br><span class="line">                q[<span class="number">7</span>:<span class="number">0</span>] &lt;= d[<span class="number">7</span>:<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                q[<span class="number">7</span>:<span class="number">0</span>] &lt;= q[<span class="number">7</span>:<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>7 D latch<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> d, </span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> q);</span><br><span class="line">	<span class="keyword">assign</span> q = ena ? d : q;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>8 DFF</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> d, </span><br><span class="line">    <span class="keyword">input</span> ar,   <span class="comment">// asynchronous reset</span></span><br><span class="line">    <span class="keyword">output</span> q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">posedge</span> ar)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(ar)</span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            q &lt;= d;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>9 DFF<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> d, </span><br><span class="line">    <span class="keyword">input</span> r,   <span class="comment">// synchronous reset</span></span><br><span class="line">    <span class="keyword">output</span> q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(r)</span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            q &lt;= d;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>10 DFF+gate</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> in, </span><br><span class="line">    <span class="keyword">output</span> out);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">    	out &lt;= in ^ out;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>11 mux and DFF<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">	<span class="keyword">input</span> clk,</span><br><span class="line">	<span class="keyword">input</span> L,</span><br><span class="line">	<span class="keyword">input</span> r_in,</span><br><span class="line">	<span class="keyword">input</span> q_in,</span><br><span class="line">	<span class="keyword">output</span> <span class="keyword">reg</span> Q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(L)</span><br><span class="line">            Q &lt;= r_in;</span><br><span class="line">    	<span class="keyword">else</span></span><br><span class="line">            Q &lt;= q_in;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>12 mux and DFF</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> w, R, E, L,</span><br><span class="line">    <span class="keyword">output</span> Q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(L)</span><br><span class="line">            Q &lt;= R;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">if</span>(E)</span><br><span class="line">                Q &lt;= w;</span><br><span class="line">        	<span class="keyword">else</span></span><br><span class="line">                Q &lt;= Q;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>13 DFFs and gate<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> x,</span><br><span class="line">    <span class="keyword">output</span> z); </span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] q = <span class="number">3&#x27;b0</span>;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        q[<span class="number">0</span>] &lt;= x ^ q[<span class="number">0</span>];</span><br><span class="line">        q[<span class="number">1</span>] &lt;= x &amp; ~q[<span class="number">1</span>];</span><br><span class="line">        q[<span class="number">2</span>] &lt;= x | ~q[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> z = ~(q[<span class="number">0</span>] | q[<span class="number">1</span>] | q[<span class="number">2</span>]);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>14 creat circuit from truth table (JK)</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> j,</span><br><span class="line">    <span class="keyword">input</span> k,</span><br><span class="line">    <span class="keyword">output</span> Q); </span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(&#123;j,k&#125;)</span><br><span class="line">            <span class="number">2&#x27;b00</span>: Q &lt;= Q;</span><br><span class="line">            <span class="number">2&#x27;b01</span>: Q &lt;= <span class="number">0</span>;</span><br><span class="line">            <span class="number">2&#x27;b10</span>: Q &lt;= <span class="number">1</span>;</span><br><span class="line">            <span class="number">2&#x27;b11</span>: Q &lt;= ~Q;            </span><br><span class="line">        <span class="keyword">endcase</span>        </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>15 detect an edge<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] pedge);</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] in_reg;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">       in_reg &lt;= in;</span><br><span class="line">        pedge &lt;= ~in_reg &amp; in;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>16 detect both edge<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>17 edge capture register<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><br>18 dual-edge triggered flip-flop<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> d,</span><br><span class="line">    <span class="keyword">output</span> q);</span><br><span class="line">    <span class="keyword">reg</span> q1,q2;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        q1 &lt;= d;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">negedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        q2 &lt;= d;</span><br><span class="line">	<span class="keyword">end</span>  </span><br><span class="line">    <span class="keyword">assign</span> q = clk ? q1 : q2;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<h4 id="3-2-2-counters"><a href="#3-2-2-counters" class="headerlink" title="3.2.2 counters"></a>3.2.2 counters</h4><p>1 foub-bit binary counter<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,      <span class="comment">// Synchronous active-high reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)</span><br><span class="line">            q &lt;= <span class="number">3&#x27;b0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2 decade counter<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,        <span class="comment">// Synchronous active-high reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)</span><br><span class="line">            q &lt;= <span class="number">3&#x27;b0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">if</span>(q == <span class="number">4&#x27;d9</span>)</span><br><span class="line">                q &lt;= <span class="number">0</span>;</span><br><span class="line">        	<span class="keyword">else</span></span><br><span class="line">            	q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>3  decade counter again<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)</span><br><span class="line">            q &lt;= <span class="number">4&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(q == <span class="number">4&#x27;d10</span>)</span><br><span class="line">            q &lt;= <span class="number">1</span>;</span><br><span class="line">      	<span class="keyword">else</span></span><br><span class="line">            q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>4 slow decade counter<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> slowena,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)</span><br><span class="line">            q &lt;= <span class="number">4&#x27;b0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">if</span> (slowena)</span><br><span class="line">            	<span class="keyword">if</span>(q == <span class="number">4&#x27;d9</span>)</span><br><span class="line">                	q &lt;= <span class="number">0</span>;</span><br><span class="line">        		<span class="keyword">else</span></span><br><span class="line">            		q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        	<span class="keyword">else</span> </span><br><span class="line">                q &lt;= q;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>5 counter 1-12<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> enable,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] Q,</span><br><span class="line">    <span class="keyword">output</span> c_enable,</span><br><span class="line">    <span class="keyword">output</span> c_load,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] c_d  ); </span><br><span class="line">	<span class="keyword">assign</span> c_enable = enable;</span><br><span class="line">    <span class="keyword">assign</span> c_load = reset | (Q == <span class="number">4&#x27;d12</span> &amp; enable);</span><br><span class="line">    <span class="keyword">assign</span> c_d = <span class="number">4&#x27;d1</span>;</span><br><span class="line">    count4 the_counter (<span class="variable">.clk</span>(clk), <span class="variable">.enable</span>(c_enable), <span class="variable">.load</span>(c_load), <span class="variable">.d</span>(c_d), <span class="variable">.Q</span>(Q));</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>13 counter 100<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">output</span> OneHertz,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">2</span>:<span class="number">0</span>] c_enable); </span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>] q1,q2,q3;</span><br><span class="line">    <span class="keyword">assign</span> c_enable[<span class="number">0</span>] = <span class="number">1&#x27;b1</span>;</span><br><span class="line">    <span class="keyword">assign</span> c_enable[<span class="number">1</span>] = (q1 == <span class="number">4&#x27;d9</span>);</span><br><span class="line">    <span class="keyword">assign</span> c_enable[<span class="number">2</span>] = (q1 == <span class="number">4&#x27;d9</span> &amp; q2 == <span class="number">4&#x27;d9</span>);</span><br><span class="line">    <span class="keyword">assign</span> OneHertz = (q1 == <span class="number">4&#x27;d9</span> &amp; q2 == <span class="number">4&#x27;d9</span> &amp; q3 == <span class="number">4&#x27;d9</span>); </span><br><span class="line">    bcdcount counter0 (clk, reset, c_enable[<span class="number">0</span>], q1);</span><br><span class="line">    bcdcount counter1 (clk, reset, c_enable[<span class="number">1</span>], q2);</span><br><span class="line">    bcdcount counter2 (clk, reset, c_enable[<span class="number">2</span>], q3);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>14 4- digit decimal counter<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,   <span class="comment">// Synchronous active-high reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">1</span>] ena,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">15</span>:<span class="number">0</span>] q);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">			ena &lt;= <span class="number">3&#x27;b0</span>;</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">			<span class="keyword">if</span> (q[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d8</span> ) <span class="keyword">begin</span></span><br><span class="line">				ena[<span class="number">1</span>] &lt;= <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				ena[<span class="number">1</span>] &lt;= <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (q[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d9</span> &amp;&amp; q[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d8</span>) <span class="keyword">begin</span></span><br><span class="line">				ena[<span class="number">2</span>] &lt;= <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				ena[<span class="number">2</span>] &lt;= <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (q[<span class="number">11</span>:<span class="number">8</span>] == <span class="number">4&#x27;d9</span> &amp;&amp; q[<span class="number">7</span>:<span class="number">4</span>] == <span class="number">4&#x27;d9</span> &amp;&amp; q[<span class="number">3</span>:<span class="number">0</span>] == <span class="number">4&#x27;d8</span>) <span class="keyword">begin</span></span><br><span class="line">				ena[<span class="number">3</span>] &lt;= <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				ena[<span class="number">3</span>] &lt;= <span class="number">0</span>;		</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">			q &lt;= <span class="number">16&#x27;b0</span>;</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">			<span class="keyword">if</span> (ena[<span class="number">1</span>]) <span class="keyword">begin</span></span><br><span class="line">				q[<span class="number">3</span>:<span class="number">0</span>] &lt;= <span class="number">4&#x27;b0</span>;</span><br><span class="line">				q[<span class="number">7</span>:<span class="number">4</span>] &lt;= q[<span class="number">7</span>:<span class="number">4</span>] + <span class="number">1&#x27;b1</span>;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">				q[<span class="number">3</span>:<span class="number">0</span>] &lt;= q[<span class="number">3</span>:<span class="number">0</span>] + <span class="number">1&#x27;b1</span>;</span><br><span class="line">				q[<span class="number">7</span>:<span class="number">4</span>] &lt;= q[<span class="number">7</span>:<span class="number">4</span>];				</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (ena[<span class="number">2</span>]) <span class="keyword">begin</span></span><br><span class="line">				q[<span class="number">7</span>:<span class="number">4</span>] &lt;= <span class="number">4&#x27;b0</span>;</span><br><span class="line">				q[<span class="number">11</span>:<span class="number">8</span>] &lt;= q[<span class="number">11</span>:<span class="number">8</span>] + <span class="number">1&#x27;b1</span>;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				q[<span class="number">11</span>:<span class="number">8</span>] &lt;= q[<span class="number">11</span>:<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (ena[<span class="number">3</span>]) <span class="keyword">begin</span></span><br><span class="line">				q[<span class="number">11</span>:<span class="number">8</span>] &lt;= <span class="number">4&#x27;b0</span>;</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">if</span> (q[<span class="number">15</span>:<span class="number">12</span>] == <span class="number">4&#x27;d9</span> )</span><br><span class="line">			    	q[<span class="number">15</span>:<span class="number">12</span>] &lt;= <span class="number">4&#x27;b0</span>;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">					q[<span class="number">15</span>:<span class="number">12</span>] &lt;= q[<span class="number">15</span>:<span class="number">12</span>] + <span class="number">1&#x27;b1</span>;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				q[<span class="number">15</span>:<span class="number">12</span>] &lt;= q[<span class="number">15</span>:<span class="number">12</span>];	</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>15 12-hour clock<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">output</span> pm,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] hh,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] mm,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] ss); </span><br><span class="line">    <span class="comment">//例化计数器表示秒</span></span><br><span class="line">    <span class="keyword">wire</span> ssl_2_ssh,ssh_2_mml;   <span class="comment">//地位向高位进位</span></span><br><span class="line">    cnt cnt_ssl(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.count_start</span>(ena),<span class="variable">.count_end</span>(<span class="number">4&#x27;d9</span>),<span class="variable">.end_cnt</span>(ssl_2_ssh),<span class="variable">.count</span>(ss[<span class="number">3</span>:<span class="number">0</span>]));</span><br><span class="line">    cnt cnt_ssh(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.count_start</span>(ssl_2_ssh),<span class="variable">.count_end</span>(<span class="number">4&#x27;d5</span>),<span class="variable">.end_cnt</span>(ssh_2_mml),<span class="variable">.count</span>(ss[<span class="number">7</span>:<span class="number">4</span>]));</span><br><span class="line">    <span class="comment">//例化计数器表示分钟</span></span><br><span class="line">    <span class="keyword">wire</span> mml_2_mmh, mmh_2_hh;</span><br><span class="line">    cnt cnt_mml(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.count_start</span>(ssh_2_mml),<span class="variable">.count_end</span>(<span class="number">4&#x27;d9</span>),<span class="variable">.end_cnt</span>(mml_2_mmh),<span class="variable">.count</span>(mm[<span class="number">3</span>:<span class="number">0</span>]));</span><br><span class="line">    cnt cnt_mmh(<span class="variable">.clk</span>(clk),<span class="variable">.reset</span>(reset),<span class="variable">.count_start</span>(mml_2_mmh),<span class="variable">.count_end</span>(<span class="number">4&#x27;d5</span>),<span class="variable">.end_cnt</span>(mmh_2_hh),<span class="variable">.count</span>(mm[<span class="number">7</span>:<span class="number">4</span>]));</span><br><span class="line">    <span class="comment">//小时计数</span></span><br><span class="line">    <span class="keyword">reg</span> a_2_p;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)<span class="keyword">begin</span></span><br><span class="line">            a_2_p &lt;= <span class="number">0</span>;</span><br><span class="line">            hh &lt;= <span class="number">8&#x27;h12</span>;        <span class="comment">// 初始条件 12:00:00 AM</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(mmh_2_hh)<span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span>(hh == <span class="number">8&#x27;h12</span>)</span><br><span class="line">                hh &lt;= <span class="number">8&#x27;h01</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                hh &lt;= hh + <span class="number">1&#x27;b1</span>;</span><br><span class="line">                <span class="keyword">if</span>(hh == <span class="number">8&#x27;h09</span>)</span><br><span class="line">                    hh &lt;= <span class="number">8&#x27;h10</span>;</span><br><span class="line">                <span class="keyword">if</span>(hh == <span class="number">8&#x27;h11</span>)</span><br><span class="line">                    a_2_p &lt;= ~ a_2_p;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> pm = a_2_p;</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//计数器子模块，可以设置开始和结束条件</span></span><br><span class="line"><span class="keyword">module</span> cnt(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> count_start,     <span class="comment">//开始计数输入</span></span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] count_end, <span class="comment">//计数到多少停止计数</span></span><br><span class="line">    <span class="keyword">output</span> end_cnt,        <span class="comment">//一次计数完成标志</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] count);</span><br><span class="line">    <span class="keyword">wire</span> add_cnt;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)<span class="keyword">begin</span></span><br><span class="line">           count &lt;= <span class="number">4&#x27;d0</span>; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(add_cnt)<span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span>(end_cnt)</span><br><span class="line">                count &lt;= <span class="number">4&#x27;d0</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                count &lt;= count + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> add_cnt = count_start;   <span class="comment">//计数开始条件，当满足了开始计数</span></span><br><span class="line">    <span class="keyword">assign</span> end_cnt = add_cnt &amp;&amp; count == count_end;    <span class="comment">//计数结束产生一个标志</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<h4 id="3-2-3-shift-registers"><a href="#3-2-3-shift-registers" class="headerlink" title="3.2.3 shift registers"></a>3.2.3 shift registers</h4><p>1 4-bit shift registers<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> areset,  <span class="comment">// async active-high reset to zero</span></span><br><span class="line">    <span class="keyword">input</span> load,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] data,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] q); </span><br><span class="line">	<span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">posedge</span> areset) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span> (areset) <span class="keyword">begin</span></span><br><span class="line">			q &lt;= <span class="number">4&#x27;b0</span>;			</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">			<span class="keyword">if</span> (load) <span class="keyword">begin</span></span><br><span class="line">			 	q &lt;= data;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (ena) <span class="keyword">begin</span></span><br><span class="line">				q &lt;= q &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">end</span>	</span><br><span class="line">			<span class="keyword">else</span> </span><br><span class="line">				q &lt;= q;		</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2 left/right rotator</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> load,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] ena,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">99</span>:<span class="number">0</span>] data,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">99</span>:<span class="number">0</span>] q); </span><br><span class="line">	<span class="keyword">integer</span> i;</span><br><span class="line">	<span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span> (load) <span class="keyword">begin</span></span><br><span class="line">			q &lt;= data;</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (ena == <span class="number">2&#x27;b01</span>) <span class="keyword">begin</span></span><br><span class="line">			q[<span class="number">99</span>] &lt;= q[<span class="number">0</span>];</span><br><span class="line">			<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= <span class="number">98</span>; i = i + <span class="number">1</span>)</span><br><span class="line">			    q[i] &lt;= q[i+<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (ena == <span class="number">2&#x27;b10</span>) <span class="keyword">begin</span></span><br><span class="line">			q[<span class="number">0</span>] &lt;= q[<span class="number">99</span>];</span><br><span class="line">			<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="number">99</span>; i = i + <span class="number">1</span>)</span><br><span class="line">			    q[i] &lt;= q[i-<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			q &lt;= q;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>3 left/rignt arthmetic shift by 1 or 8<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> load,</span><br><span class="line">    <span class="keyword">input</span> ena,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] amount,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">63</span>:<span class="number">0</span>] data,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">63</span>:<span class="number">0</span>] q); </span><br><span class="line">	<span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span> (load) <span class="keyword">begin</span></span><br><span class="line">			q &lt;= data;</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (ena) <span class="keyword">begin</span></span><br><span class="line">			<span class="keyword">case</span> (amount) </span><br><span class="line">			    <span class="number">2&#x27;b00</span>: q &lt;= q &lt;&lt;&lt; <span class="number">1</span>;</span><br><span class="line">			    <span class="number">2&#x27;b01</span>: q &lt;= q &lt;&lt;&lt; <span class="number">8</span>;</span><br><span class="line">			    <span class="number">2&#x27;b10</span>: q &lt;= &#123;&#123;q[<span class="number">63</span>]&#125;,&#123;q[<span class="number">63</span>:<span class="number">1</span>]&#125;&#125;;</span><br><span class="line">                <span class="number">2&#x27;b11</span>: q &lt;= &#123;&#123;<span class="number">8</span>&#123;q[<span class="number">63</span>]&#125;&#125;,&#123;q[<span class="number">63</span>:<span class="number">8</span>]&#125;&#125;;			            </span><br><span class="line">			<span class="keyword">endcase</span></span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			q &lt;= q;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>4 5-bit LFSR<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,    <span class="comment">// Active-high synchronous reset to 5&#x27;h1</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">4</span>:<span class="number">0</span>] q); </span><br><span class="line">	<span class="keyword">always</span> @ (<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">			q &lt;= <span class="number">4&#x27;b1</span>;        </span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">		   q[<span class="number">4</span>] &lt;= q[<span class="number">0</span>] ^ <span class="number">1&#x27;b0</span>;</span><br><span class="line">		   q[<span class="number">3</span>] &lt;= q[<span class="number">4</span>]       ;</span><br><span class="line">		   q[<span class="number">2</span>] &lt;= q[<span class="number">3</span>] ^ q[<span class="number">0</span>];</span><br><span class="line">		   q[<span class="number">1</span>] &lt;= q[<span class="number">2</span>] 	  ;</span><br><span class="line">           q[<span class="number">0</span>] &lt;= q[<span class="number">1</span>]       ;</span><br><span class="line">	    <span class="keyword">end</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>5 3-bit LFSR<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">	<span class="keyword">input</span> [<span class="number">2</span>:<span class="number">0</span>] SW,      <span class="comment">// R</span></span><br><span class="line">	<span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] KEY,     <span class="comment">// L and clk</span></span><br><span class="line">	<span class="keyword">output</span> [<span class="number">2</span>:<span class="number">0</span>] LEDR);  <span class="comment">// Q</span></span><br><span class="line">	<span class="keyword">always</span> @(<span class="keyword">posedge</span> KEY[<span class="number">0</span>]) <span class="keyword">begin</span></span><br><span class="line">		LEDR[<span class="number">0</span>] &lt;= KEY[<span class="number">1</span>] ? SW[<span class="number">0</span>] : LEDR[<span class="number">2</span>];</span><br><span class="line">		LEDR[<span class="number">1</span>] &lt;= KEY[<span class="number">1</span>] ? SW[<span class="number">1</span>] : LEDR[<span class="number">0</span>];</span><br><span class="line">		LEDR[<span class="number">2</span>] &lt;= KEY[<span class="number">1</span>] ? SW[<span class="number">2</span>] : (LEDR[<span class="number">1</span>] ^ LEDR[<span class="number">2</span>]);</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>6 32-bit LFSR<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,    <span class="comment">// Active-high synchronous reset to 32&#x27;h1</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">31</span>:<span class="number">0</span>] q ); </span><br><span class="line">	<span class="keyword">always</span> @ (<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span>(reset)</span><br><span class="line">			q &lt;= <span class="number">32&#x27;h1</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">	        q &lt;= &#123;q[<span class="number">0</span>], q[<span class="number">31</span>:<span class="number">1</span>]&#125;;</span><br><span class="line">	        q[<span class="number">31</span>] &lt;= q[<span class="number">0</span>] ^ <span class="number">1&#x27;b0</span>; </span><br><span class="line">            q[<span class="number">21</span>] &lt;= q[<span class="number">0</span>] ^ q[<span class="number">22</span>];</span><br><span class="line">	        q[<span class="number">1</span>]  &lt;= q[<span class="number">0</span>] ^ q[<span class="number">2</span>];</span><br><span class="line">	        q[<span class="number">0</span>]  &lt;= q[<span class="number">0</span>] ^ q[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>7 shift register<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> resetn,   <span class="comment">// synchronous reset</span></span><br><span class="line">    <span class="keyword">input</span> in,</span><br><span class="line">    <span class="keyword">output</span> out);</span><br><span class="line">	<span class="keyword">reg</span> q_0,q_1,q_2;</span><br><span class="line">	<span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span> (!resetn) <span class="keyword">begin</span></span><br><span class="line">			q_0 &lt;= <span class="number">0</span>;</span><br><span class="line">			q_1 &lt;= <span class="number">0</span>;</span><br><span class="line">			q_2 &lt;= <span class="number">0</span>;</span><br><span class="line">			out &lt;= <span class="number">0</span>;	</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">			q_0 &lt;= in;</span><br><span class="line">			q_1 &lt;= q_0;</span><br><span class="line">			q_2 &lt;= q_1;</span><br><span class="line">			out &lt;= q_2;				</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>8 shift register<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] SW,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] KEY,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] LEDR); </span><br><span class="line">    MUXDFF u_1(<span class="variable">.clk</span>(KEY[<span class="number">0</span>]), <span class="variable">.w</span>(KEY[<span class="number">3</span>]), <span class="variable">.E</span>(KEY[<span class="number">1</span>]), <span class="variable">.R</span>(SW[<span class="number">3</span>]), <span class="variable">.L</span>(KEY[<span class="number">2</span>]), <span class="variable">.q</span>(LEDR[<span class="number">3</span>]));</span><br><span class="line">    MUXDFF u_2(<span class="variable">.clk</span>(KEY[<span class="number">0</span>]), <span class="variable">.w</span>(LEDR[<span class="number">3</span>]), <span class="variable">.E</span>(KEY[<span class="number">1</span>]), <span class="variable">.R</span>(SW[<span class="number">2</span>]), <span class="variable">.L</span>(KEY[<span class="number">2</span>]), <span class="variable">.q</span>(LEDR[<span class="number">2</span>]));</span><br><span class="line">    MUXDFF u_3(<span class="variable">.clk</span>(KEY[<span class="number">0</span>]), <span class="variable">.w</span>(LEDR[<span class="number">2</span>]), <span class="variable">.E</span>(KEY[<span class="number">1</span>]), <span class="variable">.R</span>(SW[<span class="number">1</span>]), <span class="variable">.L</span>(KEY[<span class="number">2</span>]), <span class="variable">.q</span>(LEDR[<span class="number">1</span>]));</span><br><span class="line">    MUXDFF u_4(<span class="variable">.clk</span>(KEY[<span class="number">0</span>]), <span class="variable">.w</span>(LEDR[<span class="number">1</span>]), <span class="variable">.E</span>(KEY[<span class="number">1</span>]), <span class="variable">.R</span>(SW[<span class="number">0</span>]), <span class="variable">.L</span>(KEY[<span class="number">2</span>]), <span class="variable">.q</span>(LEDR[<span class="number">0</span>]));</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> MUXDFF (</span><br><span class="line">	<span class="keyword">input</span> clk,</span><br><span class="line">	<span class="keyword">input</span> w,</span><br><span class="line">	<span class="keyword">input</span> E,</span><br><span class="line">	<span class="keyword">input</span> R,</span><br><span class="line">	<span class="keyword">input</span> L,</span><br><span class="line">	<span class="keyword">output</span> q</span><br><span class="line">	);</span><br><span class="line">	<span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">		q &lt;= L ? R : (E ? w : q);</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>9 3-input LUT<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> enable,</span><br><span class="line">    <span class="keyword">input</span> S,</span><br><span class="line">    <span class="keyword">input</span> A, B, C,</span><br><span class="line">    <span class="keyword">output</span> Z ); </span><br><span class="line">	<span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] q;</span><br><span class="line">	<span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span> (enable) <span class="keyword">begin</span></span><br><span class="line">		    q &lt;= &#123;q[<span class="number">6</span>:<span class="number">0</span>], S&#125;;   </span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">else</span> </span><br><span class="line">			q &lt;= q;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	<span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">case</span> (&#123;A,B,C&#125;) </span><br><span class="line">		    <span class="number">3&#x27;b000</span>: Z &lt;= q[<span class="number">0</span>];</span><br><span class="line">		    <span class="number">3&#x27;b001</span>: Z &lt;= q[<span class="number">1</span>];</span><br><span class="line">		    <span class="number">3&#x27;b010</span>: Z &lt;= q[<span class="number">2</span>];</span><br><span class="line">		    <span class="number">3&#x27;b011</span>: Z &lt;= q[<span class="number">3</span>];</span><br><span class="line">		    <span class="number">3&#x27;b100</span>: Z &lt;= q[<span class="number">4</span>];</span><br><span class="line">		    <span class="number">3&#x27;b101</span>: Z &lt;= q[<span class="number">5</span>];</span><br><span class="line">		    <span class="number">3&#x27;b110</span>: Z &lt;= q[<span class="number">6</span>];</span><br><span class="line">		    <span class="number">3&#x27;b111</span>: Z &lt;= q[<span class="number">7</span>];</span><br><span class="line">		<span class="keyword">endcase</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<h4 id="3-2-4-More-Circuits"><a href="#3-2-4-More-Circuits" class="headerlink" title="3.2.4 More Circuits"></a>3.2.4 More Circuits</h4><p>1 Rule 90<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> load,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">511</span>:<span class="number">0</span>] data,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">511</span>:<span class="number">0</span>] q ); </span><br><span class="line">    <span class="keyword">integer</span> i;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(load)<span class="keyword">begin</span></span><br><span class="line">           q &lt;= data; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q[<span class="number">0</span>] &lt;= <span class="number">1&#x27;b0</span> ^ q[<span class="number">1</span>];</span><br><span class="line">            q[<span class="number">511</span>] &lt;= <span class="number">1&#x27;b0</span> ^ q[<span class="number">510</span>];</span><br><span class="line">            <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">511</span>; i = i + <span class="number">1</span>)<span class="keyword">begin</span></span><br><span class="line">                q[i] &lt;= q[i-<span class="number">1</span>] ^ q[i+<span class="number">1</span>]; </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2 Rule 110<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> load,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">511</span>:<span class="number">0</span>] data,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">511</span>:<span class="number">0</span>] q); </span><br><span class="line">    <span class="keyword">integer</span> i;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(load)<span class="keyword">begin</span></span><br><span class="line">           q &lt;= data; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            q[<span class="number">0</span>] &lt;= q[<span class="number">0</span>];</span><br><span class="line">            q[<span class="number">511</span>] &lt;= q[<span class="number">511</span>] | q[<span class="number">510</span>];</span><br><span class="line">            <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">511</span>; i = i + <span class="number">1</span>)<span class="keyword">begin</span></span><br><span class="line">                q[i] &lt;= (~q[i+<span class="number">1</span>] &amp; (q[i] | q[i-<span class="number">1</span>])) |  (q[i+<span class="number">1</span>] &amp; (q[i] ^ q[i-<span class="number">1</span>])); </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>3 Conway’s Game of Life 16x16<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> load,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">255</span>:<span class="number">0</span>] data,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">255</span>:<span class="number">0</span>] q ); </span><br><span class="line">  	<span class="keyword">integer</span> i,m,n;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">17</span>:<span class="number">0</span>] g_2d [<span class="number">17</span>:<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] sum;</span><br><span class="line">    <span class="comment">// 16×16 -&gt; 18×18</span></span><br><span class="line">    <span class="keyword">always</span>@(*) <span class="keyword">begin</span></span><br><span class="line">        g_2d[<span class="number">0</span>] = &#123;q[<span class="number">16</span>*<span class="number">15</span>], q[<span class="number">16</span>*<span class="number">15</span> +: <span class="number">16</span>], q[<span class="number">16</span>*<span class="number">16</span> -<span class="number">1</span>]&#125;;</span><br><span class="line">        g_2d[<span class="number">17</span>] = &#123;q[<span class="number">16</span>*<span class="number">0</span>], q[<span class="number">16</span>*<span class="number">0</span> +: <span class="number">16</span>],q[<span class="number">16</span>*<span class="number">1</span> -<span class="number">1</span>]&#125;;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;<span class="number">17</span>; i+=<span class="number">1</span>) <span class="keyword">begin</span> </span><br><span class="line">            g_2d[i] = &#123;q[<span class="number">16</span>*(i-<span class="number">1</span>)], q[<span class="number">16</span>*(i-<span class="number">1</span>) +: <span class="number">16</span>], q[<span class="number">16</span>*i -<span class="number">1</span>]&#125;;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span>@(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(load) <span class="keyword">begin</span></span><br><span class="line">            q &lt;= data;</span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">for</span>(m=<span class="number">0</span>; m&lt;<span class="number">16</span>; m+=<span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">for</span>(n=<span class="number">0</span>; n&lt;<span class="number">16</span>; n+=<span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">                    sum = g_2d[m][n] + g_2d[m][n+<span class="number">1</span>] + g_2d[m][n+<span class="number">2</span>] + g_2d[m+<span class="number">1</span>][n] + g_2d[m+<span class="number">1</span>][n+<span class="number">2</span>] + g_2d[m+<span class="number">2</span>][n] + g_2d[m+<span class="number">2</span>][n+<span class="number">1</span>] + g_2d[m+<span class="number">2</span>][n+<span class="number">2</span>];</span><br><span class="line">                    <span class="keyword">case</span>(sum)</span><br><span class="line">                        <span class="number">3&#x27;b010</span>: q[<span class="number">16</span>*m+n] &lt;= q[<span class="number">16</span>*m+n];</span><br><span class="line">                        <span class="number">3&#x27;b011</span>: q[<span class="number">16</span>*m+n] &lt;= <span class="number">1&#x27;b1</span>;</span><br><span class="line">                        <span class="keyword">default</span>: q[<span class="number">16</span>*m+n] &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">                    <span class="keyword">endcase</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<h4 id="3-2-5-Finite-State-Machines"><a href="#3-2-5-Finite-State-Machines" class="headerlink" title="3.2.5 Finite State Machines"></a>3.2.5 Finite State Machines</h4><p>1 simple FSM 1<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> areset,    <span class="comment">// Asynchronous reset to state B</span></span><br><span class="line">    <span class="keyword">input</span> in,</span><br><span class="line">    <span class="keyword">output</span> out);</span><br><span class="line">    <span class="keyword">parameter</span> A=<span class="number">1&#x27;b0</span>, B=<span class="number">1&#x27;b1</span>; </span><br><span class="line">    <span class="keyword">reg</span> state, next_state;</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span>    <span class="comment">// This is a combinational always block</span></span><br><span class="line">        <span class="comment">// State transition logic</span></span><br><span class="line">        <span class="keyword">if</span> (state == B) </span><br><span class="line">        	next_state = in ? B : A;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(state == A) </span><br><span class="line">        	next_state = in ? A : B;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            next_state = next_state;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk, <span class="keyword">posedge</span> areset) <span class="keyword">begin</span>    <span class="comment">// This is a sequential always block</span></span><br><span class="line">        <span class="comment">// State flip-flops with asynchronous reset</span></span><br><span class="line">        <span class="keyword">if</span> (areset) <span class="keyword">begin</span></span><br><span class="line">        	state &lt;= B;        </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        	state &lt;= next_state;        </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">// Output logic</span></span><br><span class="line">    <span class="keyword">assign</span> out = (state == B);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2 simple FSM 1.2<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(clk, reset, in, out);</span><br><span class="line">    <span class="keyword">input</span> clk;</span><br><span class="line">    <span class="keyword">input</span> reset;    <span class="comment">// Synchronous reset to state B</span></span><br><span class="line">    <span class="keyword">input</span> in;</span><br><span class="line">    <span class="keyword">output</span> out;<span class="comment">//  </span></span><br><span class="line">    <span class="keyword">reg</span> out;</span><br><span class="line">    <span class="comment">// Fill in state name declarations</span></span><br><span class="line">    <span class="keyword">parameter</span> A=<span class="number">1&#x27;b0</span>, B=<span class="number">1&#x27;b1</span>; </span><br><span class="line">    <span class="keyword">reg</span> present_state, next_state;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (reset) <span class="keyword">begin</span>  </span><br><span class="line">            present_state = B;</span><br><span class="line">        <span class="keyword">end</span> </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">case</span> (present_state)</span><br><span class="line">                B : <span class="keyword">if</span> (in == <span class="number">1&#x27;b0</span>) </span><br><span class="line">                        next_state = A;</span><br><span class="line">                	<span class="keyword">else</span> </span><br><span class="line">                		next_state = present_state;</span><br><span class="line">                A : <span class="keyword">if</span> (in == <span class="number">1&#x27;b0</span>) </span><br><span class="line">                        next_state = B;</span><br><span class="line">                	<span class="keyword">else</span> </span><br><span class="line">                		next_state = present_state;</span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">            <span class="comment">// State flip-flops</span></span><br><span class="line">            present_state = next_state;   </span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">            <span class="keyword">case</span> (present_state)</span><br><span class="line">                <span class="comment">// Fill in output logic</span></span><br><span class="line">                B : out = <span class="number">1</span>;</span><br><span class="line">                A : out = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Note the Verilog-1995 module declaration syntax here:</span></span><br><span class="line"><span class="keyword">module</span> top_module(clk, reset, in, out);</span><br><span class="line">    <span class="keyword">input</span> clk;</span><br><span class="line">    <span class="keyword">input</span> reset;    <span class="comment">// Synchronous reset to state B</span></span><br><span class="line">    <span class="keyword">input</span> in;</span><br><span class="line">    <span class="keyword">output</span> out;</span><br><span class="line">    <span class="keyword">wire</span> out;</span><br><span class="line">    <span class="comment">// Fill in state name declarations</span></span><br><span class="line">	<span class="keyword">parameter</span> A=<span class="number">1&#x27;b0</span>;</span><br><span class="line">    <span class="keyword">parameter</span> B=<span class="number">1&#x27;b1</span>;</span><br><span class="line">    <span class="keyword">reg</span> state;</span><br><span class="line">	<span class="keyword">assign</span> out = state;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (reset) <span class="keyword">begin</span>  </span><br><span class="line">            state = B;</span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">case</span> (state)</span><br><span class="line">                A: <span class="keyword">begin</span> state = (in==<span class="number">0</span>)?B:A; <span class="keyword">end</span></span><br><span class="line">                B: <span class="keyword">begin</span> state = (in==<span class="number">0</span>)?A:B; <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>3 simple FSM 2<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> areset,    <span class="comment">// Asynchronous reset to OFF</span></span><br><span class="line">    <span class="keyword">input</span> j,</span><br><span class="line">    <span class="keyword">input</span> k,</span><br><span class="line">    <span class="keyword">output</span> out); </span><br><span class="line">    <span class="keyword">parameter</span> OFF=<span class="number">0</span>, ON=<span class="number">1</span>; </span><br><span class="line">    <span class="keyword">reg</span> state, next_state;</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(state == OFF) <span class="keyword">begin</span></span><br><span class="line">            next_state = (j==<span class="number">1</span>) ? ON : OFF;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(state == ON) <span class="keyword">begin</span></span><br><span class="line">            next_state = (k==<span class="number">1</span>) ? OFF : ON;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            next_state = OFF;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk, <span class="keyword">posedge</span> areset) <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">// State flip-flops with asynchronous reset</span></span><br><span class="line">        <span class="keyword">if</span>(areset) <span class="keyword">begin</span></span><br><span class="line">            state &lt;= OFF;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            state &lt;= next_state;</span><br><span class="line">        <span class="keyword">end</span> </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">// Output logic</span></span><br><span class="line">    <span class="keyword">assign</span> out = (state == ON);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>4 simple FSM 2<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,    <span class="comment">// Asynchronous reset to OFF</span></span><br><span class="line">    <span class="keyword">input</span> j,</span><br><span class="line">    <span class="keyword">input</span> k,</span><br><span class="line">    <span class="keyword">output</span> out); </span><br><span class="line">    <span class="keyword">parameter</span> OFF=<span class="number">0</span>, ON=<span class="number">1</span>; </span><br><span class="line">    <span class="keyword">reg</span> state, next_state;</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(state == OFF) <span class="keyword">begin</span></span><br><span class="line">            next_state = (j==<span class="number">1</span>) ? ON : OFF;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(state == ON) <span class="keyword">begin</span></span><br><span class="line">            next_state = (k==<span class="number">1</span>) ? OFF : ON;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            next_state = OFF;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">// State flip-flops with asynchronous reset</span></span><br><span class="line">        <span class="keyword">if</span>(reset) <span class="keyword">begin</span></span><br><span class="line">            state &lt;= OFF;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            state &lt;= next_state;</span><br><span class="line">        <span class="keyword">end</span> </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">// Output logic</span></span><br><span class="line">    <span class="keyword">assign</span> out = (state == ON);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>5 Simple state transitions 3<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> in,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] state,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">1</span>:<span class="number">0</span>] next_state,</span><br><span class="line">    <span class="keyword">output</span> out); </span><br><span class="line">    <span class="keyword">parameter</span> A=<span class="number">0</span>, B=<span class="number">1</span>, C=<span class="number">2</span>, D=<span class="number">3</span>;</span><br><span class="line">    <span class="comment">// State transition logic: next_state = f(state, in)</span></span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            A : <span class="keyword">begin</span> next_state = in ? B: A; <span class="keyword">end</span></span><br><span class="line">            B : <span class="keyword">begin</span> next_state = in ? B: C; <span class="keyword">end</span></span><br><span class="line">            C : <span class="keyword">begin</span> next_state = in ? D: A; <span class="keyword">end</span></span><br><span class="line">            D : <span class="keyword">begin</span> next_state = in ? B: C; <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">// Output logic:  out = f(state) for a Moore state machine</span></span><br><span class="line">    <span class="keyword">assign</span> out = (state == D);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>6 Simple one-hot state transitions 3<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> in,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] state,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] next_state,</span><br><span class="line">    <span class="keyword">output</span> out); </span><br><span class="line">    <span class="keyword">parameter</span> A=<span class="number">0</span>, B=<span class="number">1</span>, C=<span class="number">2</span>, D=<span class="number">3</span>;</span><br><span class="line">    <span class="comment">// State transition logic: Derive an equation for each state flip-flop.</span></span><br><span class="line">    <span class="keyword">assign</span> next_state[A] = (state[A] &amp; ~in) | (state[C] &amp; ~in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[B] = (state[A] &amp;  in) | (state[B] &amp;  in) | (state[D] &amp;  in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[C] = (state[B] &amp; ~in) | (state[D] &amp; ~in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[D] = (state[C] &amp;  in) ;</span><br><span class="line">    <span class="comment">// Output logic: </span></span><br><span class="line">    <span class="keyword">assign</span> out = (state[D] == <span class="number">1</span>);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>7 Simple FSM3 (asynchronous reset)<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> in,</span><br><span class="line">    <span class="keyword">input</span> areset, </span><br><span class="line">    <span class="keyword">output</span> out); </span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state, next_state;</span><br><span class="line">    <span class="keyword">parameter</span> A=<span class="number">0</span>, B=<span class="number">1</span>, C=<span class="number">2</span>, D=<span class="number">3</span>;</span><br><span class="line">    <span class="comment">// State transition logic: Derive an equation for each state flip-flop.</span></span><br><span class="line">    <span class="keyword">assign</span> next_state[A] = (state[A] &amp; ~in) | (state[C] &amp; ~in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[B] = (state[A] &amp;  in) | (state[B] &amp;  in) | (state[D] &amp;  in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[C] = (state[B] &amp; ~in) | (state[D] &amp; ~in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[D] = (state[C] &amp;  in) ;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">posedge</span> areset) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(areset) <span class="keyword">begin</span></span><br><span class="line">            state &lt;= <span class="number">4&#x27;b0001</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            state &lt;= next_state;</span><br><span class="line">        <span class="keyword">end</span> </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">// Output logic</span></span><br><span class="line">    <span class="keyword">assign</span> out = (state == <span class="number">4&#x27;b1000</span>);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>8 Simple FSM3 (synchronous reset)<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> in,</span><br><span class="line">    <span class="keyword">input</span> reset,    </span><br><span class="line">    <span class="keyword">output</span> out);</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state, next_state;</span><br><span class="line">    <span class="keyword">parameter</span> A=<span class="number">0</span>, B=<span class="number">1</span>, C=<span class="number">2</span>, D=<span class="number">3</span>;</span><br><span class="line">    <span class="comment">// State transition logic: Derive an equation for each state flip-flop.</span></span><br><span class="line">    <span class="keyword">assign</span> next_state[A] = (state[A] &amp; ~in) | (state[C] &amp; ~in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[B] = (state[A] &amp;  in) | (state[B] &amp;  in) | (state[D] &amp;  in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[C] = (state[B] &amp; ~in) | (state[D] &amp; ~in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[D] = (state[C] &amp;  in) ;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset) <span class="keyword">begin</span></span><br><span class="line">            state &lt;= <span class="number">4&#x27;b0001</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            state &lt;= next_state;</span><br><span class="line">        <span class="keyword">end</span> </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">// Output logic</span></span><br><span class="line">    <span class="keyword">assign</span> out = (state == <span class="number">4&#x27;b1000</span>);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>9 Design a Moore FSM</p>
<p><img src="https://raw.githubusercontent.com/ian-lab/typorapic/master/image-20230417170817564.png" class="lazyload placeholder" data-srcset="https://raw.githubusercontent.com/ian-lab/typorapic/master/image-20230417170817564.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg" alt="image-20230417170817564"></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">1</span>] s,</span><br><span class="line">    <span class="keyword">output</span>  fr3,</span><br><span class="line">    <span class="keyword">output</span>  fr2,</span><br><span class="line">    <span class="keyword">output</span>  fr1,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> dfr</span><br><span class="line">); </span><br><span class="line"></span><br><span class="line"><span class="keyword">parameter</span> s0=<span class="number">0</span>,s1=<span class="number">1</span>,s2=<span class="number">2</span>,s3=<span class="number">3</span>,s4=<span class="number">4</span>,s5=<span class="number">5</span>,s6=<span class="number">6</span>;</span><br><span class="line"><span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] state, next_state;</span><br><span class="line"><span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] fr_reg;</span><br><span class="line"><span class="keyword">assign</span> &#123;fr3, fr2, fr1&#125; = fr_reg;</span><br><span class="line"></span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk ) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span>(reset)<span class="keyword">begin</span></span><br><span class="line">        state &lt;= s3;</span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        state &lt;= next_state;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">case</span> (state)</span><br><span class="line">        s0: <span class="keyword">begin</span></span><br><span class="line">            next_state = (s[<span class="number">3</span>] == <span class="number">0</span>) ? s1 : s0;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        s1: <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span>(s[<span class="number">3</span>] == <span class="number">1</span>)<span class="keyword">begin</span></span><br><span class="line">                next_state = s0;</span><br><span class="line">            <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">if</span>(s[<span class="number">2</span>] == <span class="number">0</span>)<span class="keyword">begin</span></span><br><span class="line">                next_state = s2;</span><br><span class="line">            <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                next_state = s1;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        s2: <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span>(s[<span class="number">1</span>] == <span class="number">0</span>)<span class="keyword">begin</span></span><br><span class="line">                next_state = s3;</span><br><span class="line">            <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">if</span>(s[<span class="number">2</span>] == <span class="number">1</span>)<span class="keyword">begin</span></span><br><span class="line">                next_state = s5;</span><br><span class="line">            <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                next_state = s2;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        s3: <span class="keyword">begin</span></span><br><span class="line">            next_state = (s[<span class="number">1</span>] == <span class="number">1</span>) ? s4 : s3;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        s4: <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span>(s[<span class="number">1</span>] == <span class="number">0</span>)<span class="keyword">begin</span></span><br><span class="line">                next_state = s3;</span><br><span class="line">            <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">if</span>(s[<span class="number">2</span>] == <span class="number">1</span>)<span class="keyword">begin</span></span><br><span class="line">                next_state = s5;</span><br><span class="line">            <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                next_state = s4;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        s5: <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span>(s[<span class="number">3</span>] == <span class="number">1</span>)<span class="keyword">begin</span></span><br><span class="line">                next_state = s0;</span><br><span class="line">            <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">if</span>(s[<span class="number">2</span>] == <span class="number">0</span>)<span class="keyword">begin</span></span><br><span class="line">                next_state = s2;</span><br><span class="line">            <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                next_state = s5;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">default</span>: <span class="keyword">begin</span></span><br><span class="line">            next_state = s3;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">endcase</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span> (state)</span><br><span class="line">            s0 : <span class="keyword">begin</span> fr_reg  = <span class="number">3&#x27;b000</span>; dfr = <span class="number">0</span>; <span class="keyword">end</span></span><br><span class="line">            s1 : <span class="keyword">begin</span> fr_reg  = <span class="number">3&#x27;b001</span>; dfr = <span class="number">1</span>; <span class="keyword">end</span></span><br><span class="line">            s2 : <span class="keyword">begin</span> fr_reg  = <span class="number">3&#x27;b011</span>; dfr = <span class="number">1</span>; <span class="keyword">end</span></span><br><span class="line">            s3 : <span class="keyword">begin</span> fr_reg  = <span class="number">3&#x27;b111</span>; dfr = <span class="number">1</span>; <span class="keyword">end</span></span><br><span class="line">            s4 : <span class="keyword">begin</span> fr_reg  = <span class="number">3&#x27;b011</span>; dfr = <span class="number">0</span>; <span class="keyword">end</span></span><br><span class="line">            s5 : <span class="keyword">begin</span> fr_reg  = <span class="number">3&#x27;b001</span>; dfr = <span class="number">0</span>; <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">default</span>: <span class="keyword">begin</span> fr_reg = <span class="number">3&#x27;b111</span>; dfr = <span class="number">1</span>; <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>10 Lemmings1<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> areset,    <span class="comment">// Freshly brainwashed Lemmings walk left.</span></span><br><span class="line">    <span class="keyword">input</span> bump_left,</span><br><span class="line">    <span class="keyword">input</span> bump_right,</span><br><span class="line">    <span class="keyword">output</span> walk_left,</span><br><span class="line">    <span class="keyword">output</span> walk_right); </span><br><span class="line">    <span class="keyword">parameter</span> LEFT=<span class="number">0</span>, RIGHT=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">reg</span> state, next_state;</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(state == LEFT)<span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span>(bump_left)<span class="keyword">begin</span> </span><br><span class="line">               next_state = RIGHT; </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                next_state = LEFT; </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span>(bump_right)<span class="keyword">begin</span> </span><br><span class="line">               next_state = LEFT; </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">               next_state = RIGHT; </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk, <span class="keyword">posedge</span> areset) <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">// State flip-flops with asynchronous reset</span></span><br><span class="line">        <span class="keyword">if</span>(areset)<span class="keyword">begin</span></span><br><span class="line">           state &lt;= LEFT; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">           state &lt;= next_state; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">// Output logic</span></span><br><span class="line">    <span class="keyword">assign</span> walk_left = (state == LEFT);</span><br><span class="line">    <span class="keyword">assign</span> walk_right = (state == RIGHT);</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>11 Lemmings2<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> areset,    <span class="comment">// Freshly brainwashed Lemmings walk left.</span></span><br><span class="line">    <span class="keyword">input</span> bump_left,</span><br><span class="line">    <span class="keyword">input</span> bump_right,</span><br><span class="line">    <span class="keyword">input</span> ground,</span><br><span class="line">    <span class="keyword">output</span> walk_left,</span><br><span class="line">    <span class="keyword">output</span> walk_right,</span><br><span class="line">    <span class="keyword">output</span> aaah ); </span><br><span class="line">    <span class="keyword">parameter</span> LEFT=<span class="number">0</span>, RIGHT=<span class="number">1</span>, FALL_L = <span class="number">2</span>, FALL_R = <span class="number">3</span>; </span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] state, next_state; </span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            LEFT : <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_L;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(bump_left)<span class="keyword">begin</span> </span><br><span class="line">               		next_state = RIGHT; </span><br><span class="line">            	<span class="keyword">end</span></span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = LEFT; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            RIGHT : <span class="keyword">begin</span> </span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_R;  </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(bump_right)<span class="keyword">begin</span> </span><br><span class="line">               		next_state = LEFT; </span><br><span class="line">            	<span class="keyword">end</span></span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = RIGHT; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            FALL_L : <span class="keyword">begin</span> </span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_L;  </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = LEFT; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            FALL_R : <span class="keyword">begin</span> </span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_R;  </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = RIGHT; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk, <span class="keyword">posedge</span> areset) <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">// State flip-flops with asynchronous reset</span></span><br><span class="line">        <span class="keyword">if</span>(areset)<span class="keyword">begin</span></span><br><span class="line">           state &lt;= LEFT; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">           state &lt;= next_state; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">// Output logic</span></span><br><span class="line">    <span class="keyword">assign</span> walk_left  = (state == LEFT);</span><br><span class="line">    <span class="keyword">assign</span> walk_right = (state == RIGHT);</span><br><span class="line">    <span class="keyword">assign</span> aaah       = (state == FALL_R | state == FALL_L);</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>12 Lemmings 3<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> areset,    <span class="comment">// Freshly brainwashed Lemmings walk left.</span></span><br><span class="line">    <span class="keyword">input</span> bump_left,</span><br><span class="line">    <span class="keyword">input</span> bump_right,</span><br><span class="line">    <span class="keyword">input</span> ground,</span><br><span class="line">    <span class="keyword">input</span> dig,</span><br><span class="line">    <span class="keyword">output</span> walk_left,</span><br><span class="line">    <span class="keyword">output</span> walk_right,</span><br><span class="line">    <span class="keyword">output</span> aaah,</span><br><span class="line">    <span class="keyword">output</span> digging );    </span><br><span class="line">    <span class="keyword">parameter</span> LEFT=<span class="number">0</span>, RIGHT=<span class="number">1</span>, FALL_L = <span class="number">2</span>, FALL_R = <span class="number">3</span>, DIG_L = <span class="number">4</span>, DIG_R = <span class="number">5</span>; </span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] state, next_state;</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            LEFT : <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_L;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(dig) <span class="keyword">begin</span></span><br><span class="line">                    next_state = DIG_L; </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(bump_left)<span class="keyword">begin</span> </span><br><span class="line">               		next_state = RIGHT; </span><br><span class="line">            	<span class="keyword">end</span></span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = LEFT; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            RIGHT : <span class="keyword">begin</span> </span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_R;  </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(dig) <span class="keyword">begin</span></span><br><span class="line">                    next_state = DIG_R; </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(bump_right)<span class="keyword">begin</span> </span><br><span class="line">               		next_state = LEFT; </span><br><span class="line">            	<span class="keyword">end</span></span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = RIGHT; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            FALL_L : <span class="keyword">begin</span> </span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_L;  </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = LEFT; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            FALL_R : <span class="keyword">begin</span> </span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_R;  </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = RIGHT; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            DIG_L : <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_L;  </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = DIG_L; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            DIG_R : <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_R;  </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = DIG_R; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk, <span class="keyword">posedge</span> areset) <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">// State flip-flops with asynchronous reset</span></span><br><span class="line">        <span class="keyword">if</span>(areset)<span class="keyword">begin</span></span><br><span class="line">           state &lt;= LEFT; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">           state &lt;= next_state; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">// Output logic</span></span><br><span class="line">    <span class="keyword">assign</span> walk_left  = (state == LEFT);</span><br><span class="line">    <span class="keyword">assign</span> walk_right = (state == RIGHT);</span><br><span class="line">    <span class="keyword">assign</span> aaah       = (state == FALL_R | state == FALL_L);</span><br><span class="line">    <span class="keyword">assign</span> digging    = (state == DIG_R  | state == DIG_L);</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>13 Lemmings4<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> areset,    <span class="comment">// Freshly brainwashed Lemmings walk left.</span></span><br><span class="line">    <span class="keyword">input</span> bump_left,</span><br><span class="line">    <span class="keyword">input</span> bump_right,</span><br><span class="line">    <span class="keyword">input</span> ground,</span><br><span class="line">    <span class="keyword">input</span> dig,</span><br><span class="line">    <span class="keyword">output</span> walk_left,</span><br><span class="line">    <span class="keyword">output</span> walk_right,</span><br><span class="line">    <span class="keyword">output</span> aaah,</span><br><span class="line">    <span class="keyword">output</span> digging ); </span><br><span class="line">    <span class="keyword">parameter</span> LEFT=<span class="number">0</span>, RIGHT=<span class="number">1</span>, FALL_L = <span class="number">2</span>, FALL_R = <span class="number">3</span>, DIG_L = <span class="number">4</span>, DIG_R = <span class="number">5</span>, SPLAT = <span class="number">6</span>; </span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] state, next_state;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">4</span>:<span class="number">0</span>] time_cnt;</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            LEFT : <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_L;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(dig) <span class="keyword">begin</span></span><br><span class="line">                    next_state = DIG_L; </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(bump_left)<span class="keyword">begin</span> </span><br><span class="line">               		next_state = RIGHT; </span><br><span class="line">            	<span class="keyword">end</span></span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = LEFT; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            RIGHT : <span class="keyword">begin</span> </span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_R;  </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(dig) <span class="keyword">begin</span></span><br><span class="line">                    next_state = DIG_R; </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(bump_right)<span class="keyword">begin</span> </span><br><span class="line">               		next_state = LEFT; </span><br><span class="line">            	<span class="keyword">end</span></span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = RIGHT; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            FALL_L : <span class="keyword">begin</span> </span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_L;  </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(time_cnt &gt; <span class="number">20</span>) <span class="keyword">begin</span></span><br><span class="line">                    next_state = SPLAT; </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = LEFT; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            FALL_R : <span class="keyword">begin</span> </span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_R;  </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(time_cnt &gt; <span class="number">20</span>) <span class="keyword">begin</span></span><br><span class="line">                    next_state = SPLAT; </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = RIGHT; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            DIG_L : <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_L;  </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                </span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = DIG_L; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            DIG_R : <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span>(~ground) <span class="keyword">begin</span></span><br><span class="line">                   next_state = FALL_R;  </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            	<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                	next_state = DIG_R; </span><br><span class="line">            	<span class="keyword">end</span> </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            SPLAT : <span class="keyword">begin</span></span><br><span class="line">                next_state = SPLAT;  </span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">posedge</span> areset) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(areset)<span class="keyword">begin</span></span><br><span class="line">           time_cnt &lt;= <span class="number">0</span>; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(~ground)<span class="keyword">begin</span></span><br><span class="line">            time_cnt &lt;= time_cnt + <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            time_cnt &lt;= <span class="number">0</span>; </span><br><span class="line">        <span class="keyword">end</span> </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk, <span class="keyword">posedge</span> areset) <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">// State flip-flops with asynchronous reset</span></span><br><span class="line">        <span class="keyword">if</span>(areset)<span class="keyword">begin</span></span><br><span class="line">           state &lt;= LEFT; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">           state &lt;= next_state; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">// Output logic</span></span><br><span class="line">    <span class="keyword">assign</span> walk_left  = (state == LEFT);</span><br><span class="line">    <span class="keyword">assign</span> walk_right = (state == RIGHT);</span><br><span class="line">    <span class="keyword">assign</span> aaah       = (state == FALL_R | state == FALL_L);</span><br><span class="line">    <span class="keyword">assign</span> digging    = (state == DIG_R  | state == DIG_L);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>14 one-hot FSM<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> in,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">9</span>:<span class="number">0</span>] state,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">9</span>:<span class="number">0</span>] next_state,</span><br><span class="line">    <span class="keyword">output</span> out1,</span><br><span class="line">    <span class="keyword">output</span> out2);</span><br><span class="line">    <span class="keyword">assign</span> next_state[<span class="number">0</span>] = (state[<span class="number">0</span>] &amp; ~in) | (state[<span class="number">1</span>] &amp; ~in) | (state[<span class="number">2</span>] &amp; ~in) | (state[<span class="number">3</span>] &amp; ~in) | (state[<span class="number">4</span>] &amp; ~in) | (state[<span class="number">7</span>] &amp; ~in) | (state[<span class="number">8</span>] &amp; ~in) | (state[<span class="number">1</span>] &amp; ~in) | (state[<span class="number">9</span>] &amp; ~in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[<span class="number">1</span>] = (state[<span class="number">0</span>] &amp; in) | (state[<span class="number">8</span>] &amp; in) | (state[<span class="number">9</span>] &amp; in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[<span class="number">2</span>] = (state[<span class="number">1</span>] &amp; in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[<span class="number">3</span>] = (state[<span class="number">2</span>] &amp; in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[<span class="number">4</span>] = (state[<span class="number">3</span>] &amp; in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[<span class="number">5</span>] = (state[<span class="number">4</span>] &amp; in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[<span class="number">6</span>] = (state[<span class="number">5</span>] &amp; in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[<span class="number">7</span>] = (state[<span class="number">6</span>] &amp; in) | (state[<span class="number">7</span>] &amp; in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[<span class="number">8</span>] = (state[<span class="number">5</span>] &amp; ~in);</span><br><span class="line">    <span class="keyword">assign</span> next_state[<span class="number">9</span>] = (state[<span class="number">6</span>] &amp; ~in);</span><br><span class="line">    <span class="keyword">assign</span> out1 = state[<span class="number">8</span>] | state[<span class="number">9</span>];</span><br><span class="line">    <span class="keyword">assign</span> out2 = state[<span class="number">7</span>] | state[<span class="number">9</span>];</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>15 PS/2 packet parser<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">input</span> reset,    <span class="comment">// Synchronous reset</span></span><br><span class="line">    <span class="keyword">output</span> done); </span><br><span class="line">    <span class="keyword">parameter</span> byte1 = <span class="number">0</span>, byte2 = <span class="number">1</span>,byte3 = <span class="number">2</span>, error = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">reg</span>[<span class="number">1</span>:<span class="number">0</span>] state, next_state;</span><br><span class="line">    <span class="comment">// State transition logic (combinational)</span></span><br><span class="line">    <span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            byte1 : <span class="keyword">begin</span> next_state = in[<span class="number">3</span>] ? byte2 : byte1; <span class="keyword">end</span></span><br><span class="line">            byte2 : <span class="keyword">begin</span> next_state = byte3; <span class="keyword">end</span></span><br><span class="line">            byte3 : <span class="keyword">begin</span> next_state = error ; <span class="keyword">end</span></span><br><span class="line">            error : <span class="keyword">begin</span> next_state = in[<span class="number">3</span>] ? byte2 : byte1 ;<span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">// State flip-flops (sequential)</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)<span class="keyword">begin</span></span><br><span class="line">            state &lt;= byte1;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">           state &lt;= next_state;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">// Output logic</span></span><br><span class="line">    <span class="keyword">assign</span> done = (state == error);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>16 PS/2 packet parser and datapath<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">input</span> reset,    <span class="comment">// Synchronous reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">23</span>:<span class="number">0</span>] out_bytes,</span><br><span class="line">    <span class="keyword">output</span> done); </span><br><span class="line">    <span class="comment">// FSM from fsm_ps2</span></span><br><span class="line">   <span class="keyword">parameter</span> byte1 = <span class="number">0</span>, byte2 = <span class="number">1</span>,byte3 = <span class="number">2</span>, error = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">reg</span>[<span class="number">1</span>:<span class="number">0</span>] state, next_state;   </span><br><span class="line">    <span class="comment">// State transition logic (combinational)</span></span><br><span class="line">    <span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            byte1 : <span class="keyword">begin</span> next_state = in[<span class="number">3</span>] ? byte2 : byte1; <span class="keyword">end</span></span><br><span class="line">            byte2 : <span class="keyword">begin</span> next_state = byte3; <span class="keyword">end</span></span><br><span class="line">            byte3 : <span class="keyword">begin</span> next_state = error ; <span class="keyword">end</span></span><br><span class="line">            error : <span class="keyword">begin</span> next_state = in[<span class="number">3</span>] ? byte2 : byte1 ;<span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">// State flip-flops (sequential)</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)<span class="keyword">begin</span></span><br><span class="line">            state &lt;= byte1;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">           state &lt;= next_state;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">// Output logic</span></span><br><span class="line">    <span class="keyword">assign</span> done = (state == error);</span><br><span class="line">    <span class="comment">// New: Datapath to store incoming bytes.</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            byte1 : <span class="keyword">begin</span> out_bytes[<span class="number">23</span>:<span class="number">16</span>] &lt;= in[<span class="number">3</span>] ? in : <span class="number">8&#x27;b0</span>; <span class="keyword">end</span></span><br><span class="line">            byte2 : <span class="keyword">begin</span> out_bytes[<span class="number">15</span>:<span class="number">8</span>] &lt;=  in; <span class="keyword">end</span></span><br><span class="line">            byte3 : <span class="keyword">begin</span> out_bytes[ <span class="number">7</span>:<span class="number">0</span>] &lt;=  in ; <span class="keyword">end</span></span><br><span class="line">            error : <span class="keyword">begin</span> out_bytes[<span class="number">23</span>:<span class="number">16</span>] &lt;= in[<span class="number">3</span>] ? in : <span class="number">8&#x27;b0</span>;<span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>17 serial receiver<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> in,</span><br><span class="line">    <span class="keyword">input</span> reset,    <span class="comment">// Synchronous reset</span></span><br><span class="line">    <span class="keyword">output</span> done); </span><br><span class="line">    <span class="keyword">parameter</span> idel = <span class="number">0</span>, start = <span class="number">1</span>, bit1=<span class="number">2</span>, bit2=<span class="number">3</span>, bit3=<span class="number">4</span>, bit4=<span class="number">5</span>, bit5=<span class="number">6</span>, bit6=<span class="number">7</span>, bit7=<span class="number">8</span>, bit8=<span class="number">9</span>, stop = <span class="number">10</span>, error =<span class="number">11</span>;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state, next_state;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)<span class="keyword">begin</span></span><br><span class="line">           state &lt;= idel;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">           state &lt;= next_state;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            idel:<span class="keyword">begin</span> next_state = ~in ? start : idel; <span class="keyword">end</span></span><br><span class="line">            start:<span class="keyword">begin</span> next_state = bit1;<span class="keyword">end</span></span><br><span class="line">            bit1:<span class="keyword">begin</span> next_state = bit2;<span class="keyword">end</span></span><br><span class="line">            bit2:<span class="keyword">begin</span> next_state = bit3;<span class="keyword">end</span></span><br><span class="line">            bit3:<span class="keyword">begin</span> next_state = bit4;<span class="keyword">end</span></span><br><span class="line">            bit4:<span class="keyword">begin</span> next_state = bit5;<span class="keyword">end</span></span><br><span class="line">            bit5:<span class="keyword">begin</span> next_state = bit6;<span class="keyword">end</span></span><br><span class="line">            bit6:<span class="keyword">begin</span> next_state = bit7;<span class="keyword">end</span></span><br><span class="line">            bit7:<span class="keyword">begin</span> next_state = bit8;<span class="keyword">end</span></span><br><span class="line">            bit8:<span class="keyword">begin</span> next_state =  in ? stop : error; <span class="keyword">end</span></span><br><span class="line">            stop:<span class="keyword">begin</span> next_state = ~in ? start : idel; <span class="keyword">end</span></span><br><span class="line">            error : <span class="keyword">begin</span> next_state = in ? idel : error; <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> done = (state == stop);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>18 serial receiver and datapath<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> in,</span><br><span class="line">    <span class="keyword">input</span> reset,    <span class="comment">// Synchronous reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] out_byte,</span><br><span class="line">    <span class="keyword">output</span> done); </span><br><span class="line">    <span class="keyword">parameter</span> idel = <span class="number">0</span>, start = <span class="number">1</span>, bit1=<span class="number">2</span>, bit2=<span class="number">3</span>, bit3=<span class="number">4</span>, bit4=<span class="number">5</span>, bit5=<span class="number">6</span>, bit6=<span class="number">7</span>, bit7=<span class="number">8</span>, bit8=<span class="number">9</span>, stop = <span class="number">10</span>, error =<span class="number">11</span>;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state, next_state;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)<span class="keyword">begin</span></span><br><span class="line">           state &lt;= idel;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">           state &lt;= next_state;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            idel:<span class="keyword">begin</span> next_state = ~in ? start : idel; <span class="keyword">end</span></span><br><span class="line">            start:<span class="keyword">begin</span> next_state = bit1;<span class="keyword">end</span></span><br><span class="line">            bit1:<span class="keyword">begin</span> next_state = bit2;<span class="keyword">end</span></span><br><span class="line">            bit2:<span class="keyword">begin</span> next_state = bit3;<span class="keyword">end</span></span><br><span class="line">            bit3:<span class="keyword">begin</span> next_state = bit4;<span class="keyword">end</span></span><br><span class="line">            bit4:<span class="keyword">begin</span> next_state = bit5;<span class="keyword">end</span></span><br><span class="line">            bit5:<span class="keyword">begin</span> next_state = bit6;<span class="keyword">end</span></span><br><span class="line">            bit6:<span class="keyword">begin</span> next_state = bit7;<span class="keyword">end</span></span><br><span class="line">            bit7:<span class="keyword">begin</span> next_state = bit8;<span class="keyword">end</span></span><br><span class="line">            bit8:<span class="keyword">begin</span> next_state =  in ? stop : error; <span class="keyword">end</span></span><br><span class="line">            stop:<span class="keyword">begin</span> next_state = ~in ? start : idel; <span class="keyword">end</span></span><br><span class="line">            error : <span class="keyword">begin</span> next_state = in ? idel : error; <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> done = (state == stop);</span><br><span class="line">    <span class="comment">// New: Datapath to latch input bits.</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            start:<span class="keyword">begin</span> out_byte[<span class="number">0</span>] &lt;= in;<span class="keyword">end</span></span><br><span class="line">            bit1:<span class="keyword">begin</span> out_byte[<span class="number">1</span>] &lt;= in;<span class="keyword">end</span></span><br><span class="line">            bit2:<span class="keyword">begin</span> out_byte[<span class="number">2</span>] &lt;= in;<span class="keyword">end</span></span><br><span class="line">            bit3:<span class="keyword">begin</span> out_byte[<span class="number">3</span>] &lt;= in;<span class="keyword">end</span></span><br><span class="line">            bit4:<span class="keyword">begin</span> out_byte[<span class="number">4</span>] &lt;= in;<span class="keyword">end</span></span><br><span class="line">            bit5:<span class="keyword">begin</span> out_byte[<span class="number">5</span>] &lt;= in;<span class="keyword">end</span></span><br><span class="line">            bit6:<span class="keyword">begin</span> out_byte[<span class="number">6</span>] &lt;= in;<span class="keyword">end</span></span><br><span class="line">            bit7:<span class="keyword">begin</span> out_byte[<span class="number">7</span>] &lt;= in; <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>19 serial receiver and parity checking<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> in,</span><br><span class="line">    <span class="keyword">input</span> reset,    <span class="comment">// Synchronous reset</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] out_byte,</span><br><span class="line">    <span class="keyword">output</span> done</span><br><span class="line">);</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">8</span>:<span class="number">0</span>] out_reg;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> out_byte = out_reg[<span class="number">7</span>:<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">parameter</span> idel = <span class="number">0</span>, start = <span class="number">1</span>, bit1=<span class="number">2</span>, bit2=<span class="number">3</span>, bit3=<span class="number">4</span>, bit4=<span class="number">5</span>, bit5=<span class="number">6</span>, bit6=<span class="number">7</span>, bit7=<span class="number">8</span>, bit8=<span class="number">9</span>, stop = <span class="number">10</span>, parity =<span class="number">11</span>, wait_stop=<span class="number">12</span>;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state, next_state;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)<span class="keyword">begin</span></span><br><span class="line">           state &lt;= idel;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">           state &lt;= next_state;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            idel:<span class="keyword">begin</span> next_state = ~in ? start : idel; <span class="keyword">end</span></span><br><span class="line">            start:<span class="keyword">begin</span> next_state = bit1;<span class="keyword">end</span></span><br><span class="line">            bit1:<span class="keyword">begin</span> next_state = bit2;<span class="keyword">end</span></span><br><span class="line">            bit2:<span class="keyword">begin</span> next_state = bit3;<span class="keyword">end</span></span><br><span class="line">            bit3:<span class="keyword">begin</span> next_state = bit4;<span class="keyword">end</span></span><br><span class="line">            bit4:<span class="keyword">begin</span> next_state = bit5;<span class="keyword">end</span></span><br><span class="line">            bit5:<span class="keyword">begin</span> next_state = bit6;<span class="keyword">end</span></span><br><span class="line">            bit6:<span class="keyword">begin</span> next_state = bit7;<span class="keyword">end</span></span><br><span class="line">            bit7:<span class="keyword">begin</span> next_state = bit8;<span class="keyword">end</span></span><br><span class="line">            bit8:<span class="keyword">begin</span> next_state = parity;<span class="keyword">end</span></span><br><span class="line">            parity:<span class="keyword">begin</span> next_state = in ? stop : wait_stop;; <span class="keyword">end</span></span><br><span class="line">            wait_stop:<span class="keyword">begin</span> next_state = ~in ? wait_stop : idel; <span class="keyword">end</span></span><br><span class="line">            stop:<span class="keyword">begin</span> next_state = ~in ? start : idel; <span class="keyword">end</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> done = (state == stop) &amp;&amp; ^out_reg;</span><br><span class="line">    <span class="comment">// New: Datapath to latch input bits.</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            start:<span class="keyword">begin</span> out_reg[<span class="number">0</span>] &lt;= in;<span class="keyword">end</span></span><br><span class="line">            bit1:<span class="keyword">begin</span> out_reg[<span class="number">1</span>] &lt;= in;<span class="keyword">end</span></span><br><span class="line">            bit2:<span class="keyword">begin</span> out_reg[<span class="number">2</span>] &lt;= in;<span class="keyword">end</span></span><br><span class="line">            bit3:<span class="keyword">begin</span> out_reg[<span class="number">3</span>] &lt;= in;<span class="keyword">end</span></span><br><span class="line">            bit4:<span class="keyword">begin</span> out_reg[<span class="number">4</span>] &lt;= in;<span class="keyword">end</span></span><br><span class="line">            bit5:<span class="keyword">begin</span> out_reg[<span class="number">5</span>] &lt;= in;<span class="keyword">end</span></span><br><span class="line">            bit6:<span class="keyword">begin</span> out_reg[<span class="number">6</span>] &lt;= in;<span class="keyword">end</span></span><br><span class="line">            bit7:<span class="keyword">begin</span> out_reg[<span class="number">7</span>] &lt;= in; <span class="keyword">end</span></span><br><span class="line">            bit8:<span class="keyword">begin</span> out_reg[<span class="number">8</span>] &lt;= in; <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<p>20 sequence recognition<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,    <span class="comment">// Synchronous reset</span></span><br><span class="line">    <span class="keyword">input</span> in,</span><br><span class="line">    <span class="keyword">output</span> disc,</span><br><span class="line">    <span class="keyword">output</span> flag,</span><br><span class="line">    <span class="keyword">output</span> err);</span><br><span class="line">    <span class="keyword">parameter</span> idel = <span class="number">0</span>, bit1 = <span class="number">1</span>, bit2=<span class="number">2</span>, bit3=<span class="number">3</span>, bit4=<span class="number">4</span>, bit5=<span class="number">5</span>, bit6=<span class="number">6</span>,bit7 = <span class="number">7</span>, s_disc= <span class="number">8</span>,s_flag = <span class="number">9</span>,s_error=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state, next_state;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)<span class="keyword">begin</span></span><br><span class="line">           state &lt;= idel; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span> </span><br><span class="line">           state &lt;= next_state; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            idel : <span class="keyword">begin</span> next_state = in ? bit1 : idel; <span class="keyword">end</span></span><br><span class="line">            bit1: <span class="keyword">begin</span> next_state = in ? bit2 : idel; <span class="keyword">end</span></span><br><span class="line">            bit2: <span class="keyword">begin</span> next_state = in ? bit3 : idel; <span class="keyword">end</span></span><br><span class="line">            bit3: <span class="keyword">begin</span> next_state = in ? bit4 : idel; <span class="keyword">end</span></span><br><span class="line">            bit4: <span class="keyword">begin</span> next_state = in ? bit6 : idel; <span class="keyword">end</span></span><br><span class="line">            bit6: <span class="keyword">begin</span> next_state = ~in ? s_disc : bit7; <span class="keyword">end</span></span><br><span class="line">            bit7: <span class="keyword">begin</span> next_state = ~in ? s_flag : s_error; <span class="keyword">end</span></span><br><span class="line">            s_error: <span class="keyword">begin</span> next_state = in ? s_error : idel; <span class="keyword">end</span></span><br><span class="line">            s_disc : <span class="keyword">begin</span> next_state = in ? bit1 : idel; <span class="keyword">end</span></span><br><span class="line">            s_flag : <span class="keyword">begin</span> next_state = in ? bit1 : idel; <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> disc = (state == s_disc);</span><br><span class="line">    <span class="keyword">assign</span> flag = (state == s_flag);</span><br><span class="line">    <span class="keyword">assign</span> err  = (state == s_error);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>21 design a Mealy FSM<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> aresetn,    <span class="comment">// Asynchronous active-low reset</span></span><br><span class="line">    <span class="keyword">input</span> x,</span><br><span class="line">    <span class="keyword">output</span> z ); </span><br><span class="line"></span><br><span class="line">    <span class="keyword">parameter</span> s0 = <span class="number">0</span>, s1 = <span class="number">1</span>, s2 = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">reg</span>[<span class="number">1</span>:<span class="number">0</span>] state,next_state;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> aresetn)  <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(!aresetn) </span><br><span class="line">            state &lt;= s0;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            state &lt;= next_state;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            s0: <span class="keyword">begin</span> next_state =  x ? s1 : s0; <span class="keyword">end</span></span><br><span class="line">            s1: <span class="keyword">begin</span> next_state = ~x ? s2 : s1; <span class="keyword">end</span></span><br><span class="line">            s2: <span class="keyword">begin</span> next_state =  x ? s1 : s0; <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">default</span> : next_state =  s0;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span>  </span><br><span class="line">    <span class="keyword">assign</span> z = (state == s2 &amp;&amp; x == <span class="number">1</span>);  </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>22 serial two’s complementer (Moore FSM)<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> areset,</span><br><span class="line">    <span class="keyword">input</span> x,</span><br><span class="line">    <span class="keyword">output</span> z</span><br><span class="line">);</span><br><span class="line">    <span class="keyword">parameter</span> A=<span class="number">2&#x27;b00</span>,B=<span class="number">2&#x27;b01</span>,C=<span class="number">2&#x27;b10</span>;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] state,next_state;</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            A: next_state = x? B:A;</span><br><span class="line">            B: next_state = x? C:B;</span><br><span class="line">            C: next_state = x? C:B;</span><br><span class="line">            <span class="keyword">default</span>: next_state = A;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">posedge</span> areset) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(areset) <span class="keyword">begin</span></span><br><span class="line">            state &lt;= A;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            state &lt;= next_state;</span><br><span class="line">        <span class="keyword">end</span>  </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> z = state==B;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>23 serial two’s complementer (Mealy FSM)</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> areset,</span><br><span class="line">    <span class="keyword">input</span> x,</span><br><span class="line">    <span class="keyword">output</span> z</span><br><span class="line">); </span><br><span class="line"><span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] state,next_state;</span><br><span class="line"><span class="keyword">parameter</span> A=<span class="number">2&#x27;b01</span>, B=<span class="number">2&#x27;b10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">posedge</span> areset) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span>(areset)<span class="keyword">begin</span></span><br><span class="line">        state &lt;= A;</span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        state &lt;= next_state;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">case</span>(state)</span><br><span class="line">        A: next_state = x ? B : A;</span><br><span class="line">        B: next_state = B;</span><br><span class="line">    <span class="keyword">endcase</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">case</span>(state)</span><br><span class="line">        A: z = x;</span><br><span class="line">        B: z = ~x;</span><br><span class="line">    <span class="keyword">endcase</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>24 Q3a: FSM<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,   <span class="comment">// Synchronous reset</span></span><br><span class="line">    <span class="keyword">input</span> s,</span><br><span class="line">    <span class="keyword">input</span> w,</span><br><span class="line">    <span class="keyword">output</span> z</span><br><span class="line">);</span><br><span class="line"><span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] state, next_state;</span><br><span class="line"><span class="keyword">parameter</span> A=<span class="number">0</span>, B1=<span class="number">1</span>, B2=<span class="number">2</span>, B3=<span class="number">3</span>;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] cnt=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span>(reset)<span class="keyword">begin</span></span><br><span class="line">        state &lt;= A;</span><br><span class="line">        cnt &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        state &lt;= next_state;</span><br><span class="line">        <span class="keyword">if</span>(state == A)</span><br><span class="line">            cnt &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(state == B1)</span><br><span class="line">            cnt &lt;= w;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            cnt &lt;= cnt + w;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">case</span>(state)</span><br><span class="line">        A: next_state = s ? B1 : A;</span><br><span class="line">        B1: next_state = B2;</span><br><span class="line">        B2: next_state = B3;</span><br><span class="line">        B3: next_state = B1;</span><br><span class="line">    <span class="keyword">endcase</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">assign</span> z = (state == B1) &amp;&amp; (cnt==<span class="number">2</span>);</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>25 Q3b: FSM<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,   <span class="comment">// Synchronous reset</span></span><br><span class="line">    <span class="keyword">input</span> x,</span><br><span class="line">    <span class="keyword">output</span> z);</span><br><span class="line">    <span class="keyword">parameter</span> s0 = <span class="number">0</span>, s1 = <span class="number">1</span>, s2 = <span class="number">2</span>, s3 = <span class="number">3</span>, s4 = <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">reg</span>[<span class="number">2</span>:<span class="number">0</span>] state,next_state;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)  <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset) </span><br><span class="line">            state &lt;= s0;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            state &lt;= next_state;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            s0: <span class="keyword">begin</span> next_state =  x ? s1 : s0; <span class="keyword">end</span></span><br><span class="line">            s1: <span class="keyword">begin</span> next_state =  x ? s4 : s1; <span class="keyword">end</span></span><br><span class="line">            s2: <span class="keyword">begin</span> next_state =  x ? s1 : s2; <span class="keyword">end</span></span><br><span class="line">            s3: <span class="keyword">begin</span> next_state =  x ? s2 : s1; <span class="keyword">end</span></span><br><span class="line">            s4: <span class="keyword">begin</span> next_state =  x ? s4 : s3; <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">default</span> : next_state =  s0;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> z = (state == s3 ||state == s4);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>26 Q3c: FSM logic<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">2</span>:<span class="number">0</span>] y,</span><br><span class="line">    <span class="keyword">input</span> x,</span><br><span class="line">    <span class="keyword">output</span> Y0,</span><br><span class="line">    <span class="keyword">output</span> z);</span><br><span class="line">    <span class="keyword">parameter</span> s0 = <span class="number">0</span>, s1 = <span class="number">1</span>, s2 = <span class="number">2</span>, s3 = <span class="number">3</span>, s4 = <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">reg</span>[<span class="number">2</span>:<span class="number">0</span>] next_state;</span><br><span class="line">    <span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(y)</span><br><span class="line">            s0: <span class="keyword">begin</span> next_state =  x ? s1 : s0; <span class="keyword">end</span></span><br><span class="line">            s1: <span class="keyword">begin</span> next_state =  x ? s4 : s1; <span class="keyword">end</span></span><br><span class="line">            s2: <span class="keyword">begin</span> next_state =  x ? s1 : s2; <span class="keyword">end</span></span><br><span class="line">            s3: <span class="keyword">begin</span> next_state =  x ? s2 : s1; <span class="keyword">end</span></span><br><span class="line">            s4: <span class="keyword">begin</span> next_state =  x ? s4 : s3; <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">default</span> : next_state =  s0;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> Y0 = next_state[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">assign</span> z = (y == s3 ||y == s4);</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>27 Q6b: FSM next-state logic<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">1</span>] y,</span><br><span class="line">    <span class="keyword">input</span> w,</span><br><span class="line">    <span class="keyword">output</span> Y2</span><br><span class="line">);</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] state,next_state;</span><br><span class="line">    <span class="keyword">parameter</span> A=<span class="number">0</span>,B=<span class="number">1</span>,C=<span class="number">2</span>,D=<span class="number">3</span>,E=<span class="number">4</span>,F=<span class="number">5</span>;</span><br><span class="line">    <span class="keyword">always</span>@(*)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(y)</span><br><span class="line">        	A:next_state=w?A:B;</span><br><span class="line">            B:next_state=w?D:C;</span><br><span class="line">            C:next_state=w?D:E;</span><br><span class="line">            D:next_state=w?A:F;</span><br><span class="line">            E:next_state=w?D:E;</span><br><span class="line">            F:next_state=w?D:C;</span><br><span class="line">            <span class="keyword">default</span>:next_state=A;</span><br><span class="line">        <span class="keyword">endcase</span>      </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> Y2=next_state[<span class="number">1</span>];</span><br><span class="line"> </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>28 Q6c: FSM one-hot next-state logic</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">6</span>:<span class="number">1</span>] y,</span><br><span class="line">    <span class="keyword">input</span> w,</span><br><span class="line">    <span class="keyword">output</span> Y2,</span><br><span class="line">    <span class="keyword">output</span> Y4);</span><br><span class="line">    <span class="keyword">assign</span> Y2 = y[<span class="number">1</span>] &amp;&amp; !w;</span><br><span class="line">    <span class="keyword">assign</span> Y4 = (y[<span class="number">2</span>] | y[<span class="number">3</span>] | y[<span class="number">5</span>] | y[<span class="number">6</span>]) &amp;&amp; w;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>29 Q6: FSM<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,     <span class="comment">// synchronous reset</span></span><br><span class="line">    <span class="keyword">input</span> w,</span><br><span class="line">    <span class="keyword">output</span> z);</span><br><span class="line">    <span class="keyword">parameter</span> A=<span class="number">0</span>,B=<span class="number">1</span>,C=<span class="number">2</span>,D=<span class="number">3</span>,E=<span class="number">4</span>,F=<span class="number">5</span>;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] state,next_state;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)<span class="keyword">begin</span></span><br><span class="line">            state &lt;= A;</span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            state &lt;= next_state;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span> (state)</span><br><span class="line">            A: next_state = w ? A : B;</span><br><span class="line">            B: next_state = w ? D : C;</span><br><span class="line">            C: next_state = w ? D : E;</span><br><span class="line">            D: next_state = w ? A : F;</span><br><span class="line">            E: next_state = w ? D : E;</span><br><span class="line">            F: next_state = w ? D : C;</span><br><span class="line">            <span class="keyword">default</span>: next_state = A;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> z = (state == E) || (state == F);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>30 Q2a: FSM<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,     <span class="comment">// synchronous reset</span></span><br><span class="line">    <span class="keyword">input</span> w,</span><br><span class="line">    <span class="keyword">output</span> z);</span><br><span class="line">    <span class="keyword">parameter</span> A=<span class="number">0</span>,B=<span class="number">1</span>,C=<span class="number">2</span>,D=<span class="number">3</span>,E=<span class="number">4</span>,F=<span class="number">5</span>;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] state,next_state;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)<span class="keyword">begin</span></span><br><span class="line">            state &lt;= A;</span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            state &lt;= next_state;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span> (state)</span><br><span class="line">            A: next_state = !w ? A : B;</span><br><span class="line">            B: next_state = !w ? D : C;</span><br><span class="line">            C: next_state = !w ? D : E;</span><br><span class="line">            D: next_state = !w ? A : F;</span><br><span class="line">            E: next_state = !w ? D : E;</span><br><span class="line">            F: next_state = !w ? D : C;</span><br><span class="line">            <span class="keyword">default</span>: next_state = A;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> z = (state == E) || (state == F);</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>31 Q2b: one-hot FSM equations<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">5</span>:<span class="number">0</span>] y,</span><br><span class="line">    <span class="keyword">input</span> w,</span><br><span class="line">    <span class="keyword">output</span> Y1,</span><br><span class="line">    <span class="keyword">output</span> Y3</span><br><span class="line">);</span><br><span class="line">    <span class="keyword">assign</span> Y1 = y[<span class="number">0</span>] &amp;&amp; w;</span><br><span class="line">    <span class="keyword">assign</span> Y3 = (y[<span class="number">1</span>] | y[<span class="number">2</span>] | y[<span class="number">4</span>] | y[<span class="number">5</span>]) &amp;&amp; !w;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>32 Q2a: FSM</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> resetn,    <span class="comment">// active-low synchronous reset</span></span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">1</span>] r,   <span class="comment">// request</span></span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">1</span>] g   <span class="comment">// grant</span></span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">parameter</span> A=<span class="number">0</span>,B=<span class="number">1</span>,C=<span class="number">2</span>,D=<span class="number">3</span>;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] state,next_state;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(!resetn)<span class="keyword">begin</span></span><br><span class="line">            state &lt;= A;</span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            state &lt;= next_state;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span> (state)</span><br><span class="line">            A: next_state = r[<span class="number">1</span>] ? B : </span><br><span class="line">                           (r[<span class="number">2</span>] ? C : </span><br><span class="line">                           (r[<span class="number">3</span>] ? D : A));</span><br><span class="line">            B: next_state = r[<span class="number">1</span>] ? B : A;</span><br><span class="line">            C: next_state = r[<span class="number">2</span>] ? C : A;</span><br><span class="line">            D: next_state = r[<span class="number">3</span>] ? D : A;</span><br><span class="line">            <span class="keyword">default</span>: next_state = A;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> g = &#123;(state == D), (state == C), (state == B)&#125; ;</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>33 Q2b: another FSM<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> resetn,    <span class="comment">// active-low synchronous reset</span></span><br><span class="line">    <span class="keyword">input</span> x,</span><br><span class="line">    <span class="keyword">input</span> y,</span><br><span class="line">    <span class="keyword">output</span> f,</span><br><span class="line">    <span class="keyword">output</span> g</span><br><span class="line">); </span><br><span class="line">    <span class="keyword">parameter</span> A=<span class="number">0</span>,B1=<span class="number">1</span>,C1=<span class="number">2</span>,C2=<span class="number">3</span>,C3=<span class="number">4</span>,D1=<span class="number">5</span>,D2=<span class="number">6</span>,D3=<span class="number">7</span>,D4=<span class="number">8</span>,B2=<span class="number">9</span>;</span><br><span class="line">    <span class="keyword">reg</span>[<span class="number">3</span>:<span class="number">0</span>]state,next_state;</span><br><span class="line">    <span class="keyword">reg</span> cout;</span><br><span class="line">    <span class="keyword">always</span>@(*)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span> (state)</span><br><span class="line">             	 A:next_state = B1;</span><br><span class="line">                 B1:next_state = B2;</span><br><span class="line">            	 B2:next_state = x?C1:B2;</span><br><span class="line">                 C1:next_state = x?C1:C2;</span><br><span class="line">                 C2:next_state = x?C3:B2;</span><br><span class="line">                 C3:next_state =y?D1:D2;</span><br><span class="line">            	D1:next_state =D1;</span><br><span class="line">                D2:next_state =y?D4:D3;</span><br><span class="line">                D3:next_state =D3;</span><br><span class="line">                D4:next_state =D4;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span>@(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(~resetn)<span class="keyword">begin</span></span><br><span class="line">           state&lt;=A; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">           state&lt;=next_state; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> f = (state==B1);</span><br><span class="line">    <span class="keyword">assign</span> g = (state==C3)||(state==D1)||(state==D2)||(state==D4);</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h3 id="3-3-Building-Larger-Circuits"><a href="#3-3-Building-Larger-Circuits" class="headerlink" title="3.3 Building Larger Circuits"></a>3.3 Building Larger Circuits</h3><p>1 Counter with period 1000<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">9</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)</span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(q==<span class="number">10&#x27;d999</span>)</span><br><span class="line">            q &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            q &lt;= q+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2 4-bit shift register and down counter<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> shift_ena,</span><br><span class="line">    <span class="keyword">input</span> count_ena,</span><br><span class="line">    <span class="keyword">input</span> data,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q);</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (shift_ena)<span class="keyword">begin</span></span><br><span class="line">            q[<span class="number">3</span>] &lt;= q[<span class="number">2</span>];</span><br><span class="line">            q[<span class="number">2</span>] &lt;= q[<span class="number">1</span>];</span><br><span class="line">            q[<span class="number">1</span>] &lt;= q[<span class="number">0</span>];</span><br><span class="line">            q[<span class="number">0</span>] &lt;= data;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">if</span>(count_ena)</span><br><span class="line">            q &lt;= q - <span class="number">1&#x27;b1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>3 FSM: Sequence 1101 recognizer<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,      <span class="comment">// Synchronous reset</span></span><br><span class="line">    <span class="keyword">input</span> data,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> start_shifting</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">parameter</span> state_1 = <span class="number">2&#x27;b00</span>;</span><br><span class="line">    <span class="keyword">parameter</span> state_2 = <span class="number">2&#x27;b01</span>;</span><br><span class="line">    <span class="keyword">parameter</span> state_3 = <span class="number">2&#x27;b10</span>;</span><br><span class="line">    <span class="keyword">parameter</span> state_4 = <span class="number">2&#x27;b11</span>;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] state;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)<span class="keyword">begin</span></span><br><span class="line">            start_shifting &lt;= <span class="number">0</span>;</span><br><span class="line">            state &lt;= state_1;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    	<span class="keyword">else</span></span><br><span class="line">            <span class="keyword">case</span>(state)</span><br><span class="line">                state_1: <span class="keyword">begin</span> <span class="keyword">if</span>(data == <span class="number">1&#x27;b1</span>) state &lt;= state_2; <span class="keyword">else</span> state &lt;= state_1; <span class="keyword">end</span></span><br><span class="line">                state_2: <span class="keyword">begin</span> <span class="keyword">if</span>(data == <span class="number">1&#x27;b1</span>) state &lt;= state_3; <span class="keyword">else</span> state &lt;= state_1; <span class="keyword">end</span></span><br><span class="line">                state_3: <span class="keyword">begin</span> <span class="keyword">if</span>(data == <span class="number">1&#x27;b0</span>) state &lt;= state_4; <span class="keyword">else</span> state &lt;= state_3; <span class="keyword">end</span></span><br><span class="line">                state_4: <span class="keyword">begin</span> <span class="keyword">if</span>(data == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span> state &lt;= state_1; start_shifting &lt;= <span class="number">1</span>;<span class="keyword">end</span> <span class="keyword">else</span> state &lt;= state_1; <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>4 FSM: Enable shift register<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,      <span class="comment">// Synchronous reset</span></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> shift_ena);</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] state;</span><br><span class="line">    <span class="keyword">parameter</span> state_1 = <span class="number">3&#x27;b00</span>;</span><br><span class="line">    <span class="keyword">parameter</span> state_2 = <span class="number">3&#x27;b01</span>;</span><br><span class="line">    <span class="keyword">parameter</span> state_3 = <span class="number">3&#x27;b10</span>;</span><br><span class="line">    <span class="keyword">parameter</span> state_4 = <span class="number">3&#x27;b11</span>;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (reset) <span class="keyword">begin</span></span><br><span class="line">            state = state_1;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">case</span> (state)</span><br><span class="line">            state_1 : <span class="keyword">begin</span> shift_ena &lt;= <span class="number">1&#x27;b1</span>; state &lt;= state_2; <span class="keyword">end</span></span><br><span class="line">            state_2 : <span class="keyword">begin</span> shift_ena &lt;= <span class="number">1&#x27;b1</span>; state &lt;= state_3; <span class="keyword">end</span></span><br><span class="line">            state_3 : <span class="keyword">begin</span> shift_ena &lt;= <span class="number">1&#x27;b1</span>; state &lt;= state_4; <span class="keyword">end</span></span><br><span class="line">            state_4 : <span class="keyword">begin</span> shift_ena &lt;= <span class="number">1&#x27;b1</span>; state &lt;= <span class="number">3&#x27;b111</span>;<span class="keyword">end</span></span><br><span class="line">            <span class="keyword">default</span> : shift_ena &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>5 FSM:The complete FSM<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,      <span class="comment">// Synchronous reset</span></span><br><span class="line">    <span class="keyword">input</span> data,</span><br><span class="line">    <span class="keyword">output</span> shift_ena,</span><br><span class="line">    <span class="keyword">output</span> counting,</span><br><span class="line">    <span class="keyword">input</span> done_counting,</span><br><span class="line">    <span class="keyword">output</span> done,</span><br><span class="line">    <span class="keyword">input</span> ack );</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">parameter</span> s1 = <span class="number">1</span>, s2 = <span class="number">2</span>, s3 = <span class="number">3</span>, s4 = <span class="number">4</span>,s5 = <span class="number">5</span>,s6 = <span class="number">6</span>,s7 = <span class="number">7</span>,s8 = <span class="number">8</span>,s9 = <span class="number">9</span>,s10 = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state,next_state;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)</span><br><span class="line">            state &lt;= s1;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            state &lt;= next_state;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            s1: <span class="keyword">begin</span> next_state = data ? s2 : s1; <span class="keyword">end</span></span><br><span class="line">            s2: <span class="keyword">begin</span> next_state = data ? s3 : s1; <span class="keyword">end</span></span><br><span class="line">            s3: <span class="keyword">begin</span> next_state = data ? s3 : s4; <span class="keyword">end</span></span><br><span class="line">            s4: <span class="keyword">begin</span> next_state = data ? s5 : s1; <span class="keyword">end</span></span><br><span class="line">            s5: <span class="keyword">begin</span> next_state = s6; <span class="keyword">end</span></span><br><span class="line">            s6: <span class="keyword">begin</span> next_state = s7; <span class="keyword">end</span></span><br><span class="line">            s7: <span class="keyword">begin</span> next_state = s8; <span class="keyword">end</span></span><br><span class="line">            s8: <span class="keyword">begin</span> next_state = s9; <span class="keyword">end</span></span><br><span class="line">            s9: <span class="keyword">begin</span> next_state = done_counting ? s10 : s9; <span class="keyword">end</span></span><br><span class="line">            s10 : <span class="keyword">begin</span>  next_state = ack ? s1 : s10; <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">default</span> : next_state = s1;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> shift_ena = (state == s5 || state == s6 || state == s7 || state == s8);</span><br><span class="line">    <span class="keyword">assign</span> counting = state == s9;</span><br><span class="line">    <span class="keyword">assign</span> done = state == s10;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>6 The complete timer<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,      <span class="comment">// Synchronous reset</span></span><br><span class="line">    <span class="keyword">input</span> data,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] count,</span><br><span class="line">    <span class="keyword">output</span> counting,</span><br><span class="line">    <span class="keyword">output</span> done,</span><br><span class="line">    <span class="keyword">input</span> ack );</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">reg</span>[<span class="number">3</span>:<span class="number">0</span>] state, next_state;    </span><br><span class="line">    <span class="keyword">reg</span>[<span class="number">9</span>:<span class="number">0</span>] cnt_1000;</span><br><span class="line">    <span class="keyword">reg</span>[<span class="number">3</span>:<span class="number">0</span>] delay;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">parameter</span> S0=<span class="number">1</span>,S1=<span class="number">2</span>,S2=<span class="number">3</span>,S3=<span class="number">4</span>,B0=<span class="number">5</span>,B1=<span class="number">6</span>,B2=<span class="number">7</span>,B3=<span class="number">8</span>,count_en=<span class="number">9</span>,Wait=<span class="number">10</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span>@(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(reset)</span><br><span class="line">            state&lt;=S0;</span><br><span class="line">    	<span class="keyword">else</span></span><br><span class="line">        	state&lt;=next_state;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span>@(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(state)</span><br><span class="line">            S0 : next_state = data ? S1:S0;</span><br><span class="line">            S1 : next_state = data ? S2:S0;</span><br><span class="line">            S2 : next_state = data ? S2:S3;</span><br><span class="line">            S3 : next_state = data ? B0:S0;</span><br><span class="line">            B0 : next_state = B1;</span><br><span class="line">            B1 : next_state = B2;</span><br><span class="line">            B2 : next_state = B3;</span><br><span class="line">            B3 : next_state = count_en;</span><br><span class="line">            count_en : next_state = (count == <span class="number">4&#x27;d0</span> &amp;&amp; cnt_1000 == <span class="number">10&#x27;d999</span>) ? Wait : count_en;</span><br><span class="line">            Wait : next_state = ack ? S0 : Wait;</span><br><span class="line">            <span class="keyword">default</span> : next_state = S0;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span>@(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    	<span class="keyword">if</span> (reset)</span><br><span class="line">            delay &lt;= <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">else</span> <span class="keyword">if</span>(state==B0||state==B1||state==B2||state==B3)</span><br><span class="line">            delay &lt;= &#123;delay[<span class="number">2</span>:<span class="number">0</span>],data&#125;;</span><br><span class="line">    	<span class="keyword">else</span> <span class="keyword">if</span>(cnt_1000==<span class="number">10&#x27;d999</span>)</span><br><span class="line">            delay &lt;= delay-<span class="number">1&#x27;b1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span>@(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">    	<span class="keyword">if</span>(reset)</span><br><span class="line">            cnt_1000 &lt;= <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">else</span> <span class="keyword">if</span>(cnt_1000==<span class="number">10&#x27;d999</span>)</span><br><span class="line">           cnt_1000 &lt;= <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">else</span> <span class="keyword">if</span>(counting)</span><br><span class="line">           cnt_1000 &lt;= cnt_1000+<span class="number">1&#x27;b1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line"> 	<span class="keyword">assign</span> count = delay;</span><br><span class="line">    <span class="keyword">assign</span> counting = state == count_en;</span><br><span class="line">    <span class="keyword">assign</span> done = state == Wait;</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>7 FSM: One-hot logic equations<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module(</span><br><span class="line">    <span class="keyword">input</span> d,</span><br><span class="line">    <span class="keyword">input</span> done_counting,</span><br><span class="line">    <span class="keyword">input</span> ack,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">9</span>:<span class="number">0</span>] state,    <span class="comment">// 10-bit one-hot current state</span></span><br><span class="line">    <span class="keyword">output</span> B3_next,</span><br><span class="line">    <span class="keyword">output</span> S_next,</span><br><span class="line">    <span class="keyword">output</span> S1_next,</span><br><span class="line">    <span class="keyword">output</span> Count_next,</span><br><span class="line">    <span class="keyword">output</span> Wait_next,</span><br><span class="line">    <span class="keyword">output</span> done,</span><br><span class="line">    <span class="keyword">output</span> counting,</span><br><span class="line">    <span class="keyword">output</span> shift_ena</span><br><span class="line">); <span class="comment">//</span></span><br><span class="line">    <span class="keyword">parameter</span> S=<span class="number">0</span>, S1=<span class="number">1</span>, S11=<span class="number">2</span>, S110=<span class="number">3</span>, B0=<span class="number">4</span>, B1=<span class="number">5</span>, B2=<span class="number">6</span>, B3=<span class="number">7</span>, Count=<span class="number">8</span>, Wait=<span class="number">9</span>;</span><br><span class="line">    <span class="keyword">assign</span> B3_next = state[B2];</span><br><span class="line">    <span class="keyword">assign</span> S_next = (state[Wait] &amp; ack) | ((state[S] | state[S1] | state[S110]) &amp; !d);</span><br><span class="line">    <span class="keyword">assign</span> S1_next = state[S] &amp; d;</span><br><span class="line">    <span class="keyword">assign</span> Count_next = state[B3] | (state[Count] &amp; !done_counting);</span><br><span class="line">    <span class="keyword">assign</span> Wait_next = (state[Count] &amp; done_counting) | (state[Wait] &amp; !ack);</span><br><span class="line">    <span class="keyword">assign</span> done = state[Wait];</span><br><span class="line">    <span class="keyword">assign</span> counting = state[Count];</span><br><span class="line">    <span class="keyword">assign</span> shift_ena = state[B0] | state[B1] | state[B2] | state[B3] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<h2 id="4-Verification-Reading-Simulations"><a href="#4-Verification-Reading-Simulations" class="headerlink" title="4 Verification: Reading Simulations"></a>4 Verification: Reading Simulations</h2><h3 id="4-1-Finding-bugs-in-code"><a href="#4-1-Finding-bugs-in-code" class="headerlink" title="4.1 Finding bugs in code"></a>4.1 Finding bugs in code</h3><p>1 Mux<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> sel,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] a,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] b,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>]out  );</span><br><span class="line">    <span class="keyword">assign</span> out = (&#123;<span class="number">8</span>&#123;sel&#125;&#125; &amp; a) | (~&#123;<span class="number">8</span>&#123;sel&#125;&#125; &amp; b);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2 NAND<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (<span class="keyword">input</span> a, <span class="keyword">input</span> b, <span class="keyword">input</span> c, <span class="keyword">output</span> out);<span class="comment">//</span></span><br><span class="line">    <span class="keyword">wire</span> temp;</span><br><span class="line">    andgate inst1 ( temp, a, b, c, <span class="number">1&#x27;b1</span>,<span class="number">1&#x27;b1</span> );</span><br><span class="line">    <span class="keyword">assign</span> out = ~temp;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>3 Mux<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] sel,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] a,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] b,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] c,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] d,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] out  ); </span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] mux0, mux1;</span><br><span class="line">    mux2 mux_0 ( sel[<span class="number">0</span>],    a,    b, mux0 );</span><br><span class="line">    mux2 mux_1 ( sel[<span class="number">0</span>],    c,    d, mux1 );</span><br><span class="line">    mux2 mux_2 ( sel[<span class="number">1</span>], mux0, mux1,  out );</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>4 Add/sub<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// synthesis verilog_input_version verilog_2001</span></span><br><span class="line"><span class="keyword">module</span> top_module ( </span><br><span class="line">    <span class="keyword">input</span> do_sub,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] a,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] b,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] out,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> result_is_zero);</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span> (do_sub)</span><br><span class="line">          <span class="number">0</span>: out = a+b;</span><br><span class="line">          <span class="number">1</span>: out = a-b;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">        <span class="keyword">if</span> (~(|out))</span><br><span class="line">            result_is_zero = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            result_is_zero = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>5 Case statement<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] code,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] out,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> valid=<span class="number">1</span> </span><br><span class="line">);<span class="comment">//</span></span><br><span class="line"></span><br><span class="line">     <span class="keyword">always</span> @(*)</span><br><span class="line">        <span class="keyword">case</span> (code)</span><br><span class="line">            <span class="number">8&#x27;h45</span>: <span class="keyword">begin</span> out = <span class="number">0</span>; valid = <span class="number">1</span>; <span class="keyword">end</span></span><br><span class="line">            <span class="number">8&#x27;h16</span>: <span class="keyword">begin</span> out = <span class="number">1</span>; valid = <span class="number">1</span>; <span class="keyword">end</span></span><br><span class="line">            <span class="number">8&#x27;h1e</span>: <span class="keyword">begin</span> out = <span class="number">2</span>; valid = <span class="number">1</span>; <span class="keyword">end</span></span><br><span class="line">            <span class="number">8&#x27;h26</span>: <span class="keyword">begin</span> out = <span class="number">3</span>; valid = <span class="number">1</span>; <span class="keyword">end</span></span><br><span class="line">            <span class="number">8&#x27;h25</span>: <span class="keyword">begin</span> out = <span class="number">4</span>; valid = <span class="number">1</span>; <span class="keyword">end</span></span><br><span class="line">            <span class="number">8&#x27;h2e</span>: <span class="keyword">begin</span> out = <span class="number">5</span>; valid = <span class="number">1</span>; <span class="keyword">end</span></span><br><span class="line">            <span class="number">8&#x27;h36</span>: <span class="keyword">begin</span> out = <span class="number">6</span>; valid = <span class="number">1</span>; <span class="keyword">end</span></span><br><span class="line">            <span class="number">8&#x27;h3d</span>: <span class="keyword">begin</span> out = <span class="number">7</span>; valid = <span class="number">1</span>; <span class="keyword">end</span></span><br><span class="line">            <span class="number">8&#x27;h3e</span>: <span class="keyword">begin</span> out = <span class="number">8</span>; valid = <span class="number">1</span>; <span class="keyword">end</span></span><br><span class="line">            <span class="number">8&#x27;h46</span>: <span class="keyword">begin</span> out = <span class="number">9</span>; valid = <span class="number">1</span>; <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">default</span>: <span class="keyword">begin</span> out = <span class="number">0</span>; valid = <span class="number">0</span>;<span class="keyword">end</span></span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<h3 id="4-2-Build-a-circuit-from-a-simulation-waveform"><a href="#4-2-Build-a-circuit-from-a-simulation-waveform" class="headerlink" title="4.2 Build a circuit from a simulation waveform"></a>4.2 Build a circuit from a simulation waveform</h3><p>1 Combinational circuit 1<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">input</span> b,</span><br><span class="line">    <span class="keyword">output</span> q );</span><br><span class="line">    <span class="keyword">assign</span> q = a&amp;b; <span class="comment">// Fix me</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2 Combinational circuit 2<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">input</span> b,</span><br><span class="line">    <span class="keyword">input</span> c,</span><br><span class="line">    <span class="keyword">input</span> d,</span><br><span class="line">    <span class="keyword">output</span> q );</span><br><span class="line">    <span class="keyword">assign</span> q = ((a+b+c+d) == <span class="number">2</span>) | ((a+b+c+d) == <span class="number">0</span>) | ((a+b+c+d) == <span class="number">4</span>); <span class="comment">// Fix me</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>3 Combinational circuit 3<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">input</span> b,</span><br><span class="line">    <span class="keyword">input</span> c,</span><br><span class="line">    <span class="keyword">input</span> d,</span><br><span class="line">    <span class="keyword">output</span> q );</span><br><span class="line">    <span class="keyword">assign</span> q = (a&amp;c) | (a&amp;d) | (b&amp;c) | (b&amp;d); <span class="comment">// Fix me</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>4 Combinational circuit 4<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">input</span> b,</span><br><span class="line">    <span class="keyword">input</span> c,</span><br><span class="line">    <span class="keyword">input</span> d,</span><br><span class="line">    <span class="keyword">output</span> q );</span><br><span class="line">    <span class="keyword">assign</span> q = b|c; </span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>5 Combinational circuit 5</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] a,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] b,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] c,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] d,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] e,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q );</span><br><span class="line">    <span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(c)</span><br><span class="line">            <span class="number">4&#x27;d0</span> : q = b;</span><br><span class="line">            <span class="number">4&#x27;d1</span> : q = e;</span><br><span class="line">            <span class="number">4&#x27;d2</span> : q = a;</span><br><span class="line">            <span class="number">4&#x27;d3</span> : q = d;</span><br><span class="line">            <span class="keyword">default</span> : q = <span class="number">4&#x27;hf</span>;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>6 Combinational circuit 6<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">2</span>:<span class="number">0</span>] a,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">15</span>:<span class="number">0</span>] q ); </span><br><span class="line">    <span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span>(a)</span><br><span class="line">            <span class="number">3&#x27;b000</span>: q = <span class="number">16&#x27;h1232</span>;</span><br><span class="line">			<span class="number">3&#x27;b001</span>: q = <span class="number">16&#x27;haee0</span>;</span><br><span class="line">			<span class="number">3&#x27;b010</span>: q = <span class="number">16&#x27;h27d4</span>;</span><br><span class="line">			<span class="number">3&#x27;b011</span>: q = <span class="number">16&#x27;h5a0e</span>;</span><br><span class="line">			<span class="number">3&#x27;b100</span>: q = <span class="number">16&#x27;h2066</span>;</span><br><span class="line">			<span class="number">3&#x27;b101</span>: q = <span class="number">16&#x27;h64ce</span>;</span><br><span class="line">			<span class="number">3&#x27;b110</span>: q = <span class="number">16&#x27;hc526</span>;</span><br><span class="line">			<span class="number">3&#x27;b111</span>: q = <span class="number">16&#x27;h2f19</span>;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>7 Sequential circuit 7<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">output</span> q );</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">       q &lt;= ~a; </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>8 Sequential circuit 8<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clock,</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> p,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> q );</span><br><span class="line">    <span class="keyword">always</span> @(*)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(clock)</span><br><span class="line">            p &lt;= a;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">negedge</span> clock)</span><br><span class="line">        q &lt;= a;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>9 Sequential circuit 9<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] q );</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</span><br><span class="line">        <span class="keyword">if</span>(a)</span><br><span class="line">            q &lt;= <span class="number">4&#x27;d4</span>;</span><br><span class="line">    	<span class="keyword">else</span> <span class="keyword">if</span>(q == <span class="number">4&#x27;d6</span>)</span><br><span class="line">        	q&lt;=<span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">else</span></span><br><span class="line">            q &lt;= q + <span class="number">1&#x27;b1</span>;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>10 Sequential circuit 10<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module (</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> a,</span><br><span class="line">    <span class="keyword">input</span> b,</span><br><span class="line">    <span class="keyword">output</span> q,</span><br><span class="line">    <span class="keyword">output</span> state );</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)<span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(a==b)</span><br><span class="line">            state &lt;= a;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> q = (a==b) ? state : ~state;</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h2 id="5-Verification-Writing-Testbenches"><a href="#5-Verification-Writing-Testbenches" class="headerlink" title="5 Verification: Writing Testbenches"></a>5 Verification: Writing Testbenches</h2><p>1 clock<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module ( );</span><br><span class="line">    <span class="keyword">reg</span> clk;</span><br><span class="line">    <span class="keyword">initial</span> clk = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">always</span> #<span class="number">5</span> clk = ~clk; </span><br><span class="line">    dut dut_0(clk);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>2 Testbench1<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module ( <span class="keyword">output</span> <span class="keyword">reg</span> A, <span class="keyword">output</span> <span class="keyword">reg</span> B );</span><br><span class="line">    <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">		A = <span class="number">0</span>; B = <span class="number">0</span>;</span><br><span class="line">    	#<span class="number">10</span> A = <span class="number">1</span>;</span><br><span class="line">        #<span class="number">5</span> B = <span class="number">1</span>;</span><br><span class="line">        #<span class="number">5</span> A = <span class="number">0</span>;</span><br><span class="line">        #<span class="number">20</span> B = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>3 AND gate<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module();</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] in;</span><br><span class="line">    <span class="keyword">wire</span> out;</span><br><span class="line">    <span class="keyword">initial</span> in = <span class="number">2&#x27;d00</span>;</span><br><span class="line">    <span class="keyword">initial</span> #<span class="number">20</span> in[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">        #<span class="number">10</span> in[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        #<span class="number">10</span> in[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        #<span class="number">10</span> in[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    andgate u0(in, out);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>4 Testbench2<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module();</span><br><span class="line">    <span class="keyword">reg</span> clk;</span><br><span class="line">    <span class="keyword">reg</span> in;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] s;</span><br><span class="line">    <span class="keyword">wire</span> out;</span><br><span class="line">    <span class="keyword">always</span> #<span class="number">5</span> clk = ~clk; </span><br><span class="line">    <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">    	clk = <span class="number">0</span>;</span><br><span class="line">        in = <span class="number">0</span>;</span><br><span class="line">        s = <span class="number">3&#x27;d2</span>;</span><br><span class="line">        #<span class="number">10</span> s = <span class="number">3&#x27;d6</span>;</span><br><span class="line">        #<span class="number">10</span> s = <span class="number">3&#x27;d2</span>; in = <span class="number">1</span>;</span><br><span class="line">        #<span class="number">10</span> s = <span class="number">3&#x27;d7</span>; in = <span class="number">0</span>;</span><br><span class="line">        #<span class="number">10</span> s = <span class="number">3&#x27;d0</span>; in = <span class="number">1</span>;</span><br><span class="line">        #<span class="number">30</span> in = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    q7 u0(clk, in, s, out);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><br>5 T flip-flop<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> top_module ();</span><br><span class="line">    <span class="keyword">reg</span> clk, reset, t;</span><br><span class="line">    <span class="keyword">wire</span> q;</span><br><span class="line">    <span class="keyword">always</span> #<span class="number">5</span> clk = ~clk;</span><br><span class="line">    <span class="keyword">initial</span> <span class="keyword">begin</span> </span><br><span class="line">    	clk = <span class="number">0</span>;</span><br><span class="line">        reset =<span class="number">0</span>;</span><br><span class="line">        t = <span class="number">0</span>;</span><br><span class="line">        #<span class="number">10</span> reset = <span class="number">1</span>;</span><br><span class="line">        #<span class="number">10</span> reset = <span class="number">0</span>; t = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    tff u0( clk, reset, t,q);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>

      </div>
      <div class="post-tags-categories">
        
        <div class="tags">
          
            <a href="/tags/Verilog/" class="">
              Verilog
            </a>
          
        </div>
        
      </div>
      
        <div class="copyright">
  <ul class="post-copyright">
    <li class="post-copyright-author">
    <strong>作者:  </strong>ian</a>
    </li>
    <li class="post-copyright-link">
    <strong>文章链接:  </strong>
    <a href="/2023/04/02/HDLBits/" target="_blank" title="HDLBits">https://ian-lab.github.io/2023/04/02/HDLBits/</a>
    </li>
    <li class="post-copyright-license">
      <strong>版权声明:   </strong>
      本网站所有文章除特别声明外,均采用 <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
      许可协议。转载请注明出处!
    </li>
  </ul>
<div>
      
    </article>
    <!-- 上一篇文章和下一篇文章 -->
    
      <!-- 文章详情页的上一页和下一页 -->
<div class="post-nav">



  
  <div class="post-nav-prev post-nav-item">
    <div class="post-nav-img" style="background-size: cover; 
      background-position: center center;">
      <img class="lazyload lazyload placeholder" src="/medias/9.jpg" class="lazyload placeholder" data-srcset="/medias/9.jpg" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg" alt="">
    </div>
    <a href="/2023/04/02/APB%E6%80%BB%E7%BA%BF/" class="post-nav-link">
      <div class="title">
        <i class="fas fa-angle-left"></i> 上一篇:
        <div class="title-text">APB总线</div>
      </div>
      
      <!-- <div class="content">
        高级外设总线(Advanced Peripheral Bus，APB) 是AMBA协议之一，也是最基本的总线协议。按照A
      </div> -->
    </a>
  </div>



  
  <div class="post-nav-next post-nav-item">
    <div class="post-nav-img" style="background-size: cover; 
      background-position: center center;">
      <img class="lazyload lazyload placeholder" src="/medias/7.jpg" class="lazyload placeholder" data-srcset="/medias/7.jpg" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg" src="" alt="">
    </div>
    <a href="/2021/10/19/hello-world/" class="post-nav-link">
      <div class="title">
        下一篇: <i class="fas fa-angle-right"></i>
        <div class="title-text">Hello World</div>
      </div>
      <!-- <div class="content">
        Welcome to Hexo! This is your very first post. Check documen
      </div> -->
    </a>
  </div>

</div>

    
    

    <!-- 打赏 -->
    

    <!-- 分享 -->
    
      <!-- https://github.com/overtrue/share.js -->
<!-- 文章详情页的分享 -->
<div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>

<script src="/js/shareJs/social-share.min.js"></script>
</script>

<style>
  .social-share {
    margin: 20px 0;
  }
</style>


    
    
    <!-- 评论 -->
    <!-- 评论 -->

  <div id="myComment">
    
      <div id="gitment-container"></div>

    
  </div>

<!-- comment script in themes\hexo-theme-bamboo\layout\_partial\scripts\index.ejs -->


  </div>

  <!-- 目录 -->
  <!-- 文章详情页右侧目录 -->

  <div class="toc-aside">
    <div class="toc-main">
      <div class="toc-aside-title">
        <i class="fas fa-list-ul" aria-hidden="true"></i><span>本文目录</span>
        
          <div class="toc-open-close">本文目录</div>
        
      </div>
      <div class="toc-content">
        <div class="toc"></div>
      </div>
    </div>
  </div>

  <!-- 手机端目录按钮 -->
  <div id="toc-mobile-btn">
    <i class="fas fa-list-ul" aria-hidden="true"></i>
  </div>
  <!-- js在scripts目录下的的toc.ejs里面 -->
  

  <script>
    function openBtnClickFn () {
      let openOrCloseBtn = $('.toc-aside .toc-aside-title .toc-open-close');
      let open = eval('' || 'true');
      openOrCloseBtn.click(function() {
        if (open === true) {
          $(".toc-aside").css({'width': 0, 'padding': 0});
          $(".toc-content").css({'width': 0});
          $(".toc-aside-title span, .toc-aside-title i").css({'display': 'none'});
          $(".main-content").css({'width': '75%', 'margin': '10px auto'});
          open = false;
        } else {
          $(".toc-aside").css({'width': '300px', 'padding': '0 10px'});
          $(".toc-content").css({'width': '300px'});
          $(".toc-aside-title span, .toc-aside-title i").css({'display': 'inline-block'});
          $(".main-content").css({'width': '65%', 'margin-right': '10px', 'margin-left': 'calc(35% - 350px)'});
          open = true;
        }
      });
    };
    openBtnClickFn();
    document.addEventListener('pjax:complete', function () {
      openBtnClickFn();
    })
    
  </script>


  <!-- 图片放大 Wrap images with fancybox support -->
  <script src="/js/wrapImage.js"></script>
</div>

<!-- 文章详情页背景图 -->
<div id="appBgSwiper" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -2;"
	:style="{'background-color': bgColor ? bgColor : 'transparent'}">
	<transition-group tag="ul" :name="names">
		<li v-for='(image,index) in img' :key='index' v-show="index === mark" class="bg-swiper-box">
			<img :src="image" class="bg-swiper-img no-lazy">
		</li>
	</transition-group>
</div>
<script>
	var vm = new Vue({
		el: '#appBgSwiper',
		data: {
			names: '' || 'fade' || 'fade', // translate-fade fade
			mark: 0,
			img: [],
			bgColor: '',
			time: null
		},
		methods: {   //添加方法
			change(i, m) {
				if (i > m) {
					// this.names = 'fade';
				} else if (i < m) {
					// this.names = 'fade';
				} else {
					return;
				}
				this.mark = i;
			},
			prev() {
				// this.names = 'fade';
				this.mark--;
				if (this.mark === -1) {
					this.mark = 3;
					return
				}
			},
			next() {
				// this.names = 'fade';
				this.mark++;
				if (this.mark === this.img.length) {
					this.mark = 0;
					return
				}
			},
			autoPlay() {
				// this.names = 'fade';
				this.mark++;
				if (this.mark === this.img.length) {
					this.mark = 0;
					return
				}
			},
			play() {
				let bgImgDelay = '' || '180000'
				let delay = parseInt(bgImgDelay) || 180000;
				this.time = setInterval(this.autoPlay, delay);
			},
			enter() {
				clearInterval(this.time);
			},
			leave() {
				this.play();
			}
		},
		created() {
			this.play()
		},
		beforeDestroy() {
			clearInterval(this.time);
		},
		mounted() {
			let prop = '' || '';
			let isImg = prop.includes('.bmp') || prop.includes('.jpg') || prop.includes('.png') || prop.includes('.tif') || prop.includes('.gif') || prop.includes('.pcx') || prop.includes('.tga') || prop.includes('.exif') || prop.includes('.fpx') || prop.includes('.psd') || prop.includes('.cdr') || prop.includes('.pcd') || prop.includes('.dxf') || prop.includes('.ufo') || prop.includes('.eps') || prop.includes('.ai') || prop.includes('.raw') || prop.includes('.WMF') || prop.includes('.webp') || prop.includes('.jpeg') || prop.includes('http://') || prop.includes('https://')
			if (isImg) {
				let img = prop.split(',');
				let configRoot = '/'
				let arrImg = [];
				img.forEach(el => {
					var Expression = /http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/;
					var objExp = new RegExp(Expression);

					if (objExp.test(el)) {
						// http or https
						arrImg.push(el);
					} else {
						// 非http or https开头
						// 本地文件
						let firstStr = el.charAt(0);
						if (firstStr == '/') {
							el = el.substr(1); // 删除第一个字符 '/',因为 configRoot最后一个字符为 /
						}
						el = configRoot + el;
						arrImg.push(el);
					}
				})
				this.img = arrImg;
			} else {
				this.bgColor = prop;
			}
		}
	})
</script>

<style>
	.bg-swiper-box {
		position: absolute;
		display: block;
		width: 100%;
		height: 100%;
	}

	.bg-swiper-img {
		object-fit: cover;
		width: 100%;
		height: 100%;
	}
</style>


  <script>
  // https://github.com/theme-next/hexo-theme-next/blob/master/layout/_third-party/math/mathjax.swig
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.0/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    // 文章章节标题不能为 “MathJax” ，否则会报错。
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>




  <script>
  function loadMermaid() {
    if (document.getElementsByClassName('mermaid').length) {
      if (window.mermaidJsLoad) mermaid.init()
      else {
        loadScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
          window.mermaidJsLoad = true
          mermaid.initialize({
            theme: 'default',
          })
          if ('true') {
            mermaid.init();
          }
        })
      }
    }
  };
  document.addEventListener("DOMContentLoaded", function () {
    loadMermaid();
  })

  document.addEventListener('pjax:complete', function () {
    loadMermaid();
  })
  
</script>


      </main>
    </div>

    <!-- 页脚 -->
    
  
  <div class="footer bg-color">
    <div class="footer-main">
      
        
          <div class="link">
            
          </div>
        
      
        
          <div class="footer-copyright">
            <p>Copyright © 2019 - 2020 <a target="_blank" rel="noopener" href="https://github.com/yuang01">yuang01</a> | Powered by <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">Hexo</a> | Theme <a target="_blank" rel="noopener" href="https://github.com/yuang01/theme">Bamboo</a> </p>

          </div>
        
      
        
          <div class="footer-custom">
            
          </div>
        
      
    </div>
  </div>



    <!-- 渲染暗黑按钮 -->
    
      <div class="dark">
  <div class="dark-content">
    <i class="fas fa-moon" aria-hidden="true"></i>
    <!-- <span>关灯</span> -->
  </div>
  
</div>

<script>
  $(function() {
    let isDark = JSON.parse(localStorage.getItem('dark'))  || JSON.parse('false');
    if (isDark) {
      $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fas fa-lightbulb" aria-hidden="true"></i>
          </div>
          `
        );
    }
    $('.dark').click(function() {
      if ($(document.body).is('.darkModel')) {
        $(document.body).removeClass('darkModel');
        localStorage.setItem('dark', false);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fas fa-moon" aria-hidden="true"></i>
          </div>
          `
        );
      } else {
        $(document.body).addClass('darkModel');
        localStorage.setItem('dark', true);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fas fa-lightbulb" aria-hidden="true"></i>
          </div>
          `
        );
      }
    })
  })
</script>
    
    <!-- 渲染回到顶部按钮 -->
    
      <div class="goTop top-btn-color" pointer>
  <i class="fas fa-arrow-up" aria-hidden="true"></i>
</div>
<script src="/js/goTop.js"></script>

    
    <!-- 渲染左下角音乐播放器 -->
    

    <!-- 图片放大 -->
    

    <!-- 百度解析 -->
    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <!-- 背景彩带 -->
    
      <script type="text/javascript" size="100" alpha='0.4' zIndex="-1" src="/js/ribbon.min.js"></script>
    

    <script src="/js/utils/index.js"></script>
    <script src="/js/app.js" data-pjax></script>
    
    <!-- 文章目录所需js -->
<link href="/js/tocbot/tocbot.css" rel="stylesheet">
<script src="/js/tocbot/tocbot.min.js"></script>

<script>
  var headerEl = 'h2, h3, h4',  //headers 
    content = '.post-detail',//文章容器
    idArr = {};  //标题数组以确定是否增加索引id
  //add #id
  var option = {
    // Where to render the table of contents.
    tocSelector: '.toc',
    // Where to grab the headings to build the table of contents.
    contentSelector: content,
    // Which headings to grab inside of the contentSelector element.
    headingSelector: headerEl,
    scrollSmooth: true,
    scrollSmoothOffset: -80,
    headingsOffset: -($(window).height() * 0.4 - 45),
    positionFixedSelector: '.toc-main',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto',
    activeLinkClass: 'is-active-link',
    // onClick: function (e) {},
  }
  if ($('.toc').length > 0) {

    $(content).children(headerEl).each(function () {
      //去除空格以及多余标点
      var headerId = $(this).text().replace(/[\s|\~|`|\!|\@|\#|\$|\%|\^|\&|\*|\(|\)|\_|\+|\=|\||\|\[|\]|\{|\}|\;|\:|\"|\'|\,|\<|\.|\>|\/|\?|\：|\，|\。]/g, '');

      headerId = headerId.toLowerCase();
      if (idArr[headerId]) {
        //id已经存在
        $(this).attr('id', headerId + '-' + idArr[headerId]);
        idArr[headerId]++;
      }
      else {
        //id未存在
        idArr[headerId] = 1;
        $(this).attr('id', headerId);
      }
    });

    document.addEventListener("DOMContentLoaded", function () {
      tocbot.init(option);
      mobileTocClick();
    });

  }

  window.tocScrollFn = function () {
    return bamboo.throttle(function () {
      findHeadPosition();
    }, 100)()
  }
  window.addEventListener('scroll', tocScrollFn);

  const findHeadPosition = function (top) {
    if ($('.toc-list').length <= 0) {
      return false;
    }
    setTimeout(() => {  // or DOMContentLoaded 
      autoScrollToc();
    }, 0);
  }

  const autoScrollToc = function () {
    const $activeItem = document.querySelector('.is-active-link');
    const $cardToc = document.querySelector('.toc-content');
    const activePosition = $activeItem.getBoundingClientRect().top
    const sidebarScrollTop = $cardToc.scrollTop
    if (activePosition > (document.documentElement.clientHeight - 100)) {
      $cardToc.scrollTop = sidebarScrollTop + 150
    }
    if (activePosition < 100) {
      $cardToc.scrollTop = sidebarScrollTop - 150
    }
  }

  document.addEventListener('pjax:send', function () {
    if ($('.toc').length) {
      tocbot.destroy();
    }
  });

  document.addEventListener('pjax:complete', function () {
    if ($('.toc').length) {
      tocbot.init(option);
      mobileTocClick();
    }
  });
  
  // 手机端toc按钮点击出现目录
  const mobileTocClick = function () {
    const $cardTocLayout = document.getElementsByClassName('toc-aside')[0];
    const $cardToc = $cardTocLayout.getElementsByClassName('toc-content')[0];
    let right = '45px';
    if (window.innerWidth >= 551 && window.innerWidth <= 992) {
      right = '100px'
    }
    const mobileToc = {
      open: () => {
        $cardTocLayout.style.cssText = 'animation: toc-open .3s; opacity: 1; right: ' + right
      },

      close: () => {
        $cardTocLayout.style.animation = 'toc-close .2s'
        setTimeout(() => {
          $cardTocLayout.style.cssText = "opacity:''; animation: ''; right: ''"
        }, 100)
      }
    }
    document.getElementById('toc-mobile-btn').addEventListener('click', () => {
      if (window.getComputedStyle($cardTocLayout).getPropertyValue('opacity') === '0') mobileToc.open()
      else mobileToc.close()
    })

    $cardToc.addEventListener('click', (e) => {
      if (window.innerWidth < 992) { // 小于992px的时候
        mobileToc.close()
      }
    })
  }
</script>

<style>
  .is-position-fixed {
    position: sticky !important;
    top: 74px;
  }

  .toc-main ul {
    counter-reset: show-list;
  }

  .toc-main ul li::before {
    content: counter(item)".";
    display: block;
    position: absolute;
    left: 12px;
    top: 0;
  }
</style> 

<!-- 渲染issues标签里的内容 -->
<script>
  function loadIssuesJS() {
    if ($(".post-detail").find(".issues-api").length == 0) {
      return;
    } 
    loadScript('/js/issues/index.js');
  };
  $(function () {
    loadIssuesJS();
  });
  document.addEventListener('pjax:complete', function () {
    if (typeof IssuesAPI == "undefined") {
      loadIssuesJS();
    }
  })
</script>

<!-- 输入框打字特效 -->
<!-- 输入框打字特效 -->


<!-- markdown代码一键复制功能 -->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/v-plugs-ayu/lib/ayu.css">
  <script src="https://cdn.jsdelivr.net/npm/v-plugs-ayu/lib/ayu.umd.min.js"></script>
  <script src="/js/clipboard/clipboard.min.js"></script>
  <div id="appCopy">
  </div>
  <script data-pjax>
    var vm = new Vue({
      el: '#appCopy',
      data: {
      },
      computed: {
      },
      mounted() {
        const that = this;
        var copy = '复制';
        /* code */
        var initCopyCode = function () {
          var copyHtml = '';
          copyHtml += '<button class="btn-copy" data-clipboard-snippet="" style="position:absolute;top:0;right:0;z-index:1;">';
          copyHtml += '<i class="fas fa-copy"></i><span>' + copy + '</span>';
          copyHtml += '</button>';
          $(".post-detail pre").not('.gutter pre').wrap("<div class='codeBox' style='position:relative;width:100%;'></div>")
          $(".post-detail pre").not('.gutter pre').before(copyHtml);
          new ClipboardJS('.btn-copy', {
            target: function (trigger) {
              return trigger.nextElementSibling;
            }
          });
        }
        initCopyCode();
        $('.btn-copy').unbind('click').bind('click', function () {
          doSomething();
        })
        $(document).unbind('keypress').bind('keypress', function (e) {
          if (e.ctrlKey && e.keyCode == 67) {
            doSomething();
          }
        })

        function doSomething() {
          that.$notify({
            title: "成功",
            content: "代码已复制",
            type: 'success'
          })
        }
      },
      methods: {
      },
      created() { }
    })
  </script>
  

<!-- 图片懒加载 -->
<script defer src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.1.0/dist/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 0
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    lazyLoadInstance.update();
  });
  document.addEventListener('pjax:complete', function () {
    lazyLoadInstance.update();
  });
</script>


<!-- 卡片滚动动画 -->
   

<!-- 评论所需js -->

  
    <script type="text/javascript">
  var utteranceCommon = {};

  function check_utterance() {
    let isDark = JSON.parse(localStorage.getItem('dark')) || JSON.parse('false');
    if (isDark) {
      utteranceCommon.Theme = 'github-dark';
    } else {
      utteranceCommon.Theme = 'github-light';
    }

    return document.getElementById("gitment-container");
  }
  comment_el = '#gitment-container';
  load_utterance = function () {
    if ($(comment_el).length) {
      // 匿名函数，防止污染全局变量
      const HEAD = check_utterance();

      var utterances = document.createElement('script');
      utterances.type = 'text/javascript';
      utterances.async = true;
      utterances.setAttribute('issue-term', 'pathname')
      utterances.setAttribute('theme', utteranceCommon.Theme)
      utterances.setAttribute('repo', '')
      utterances.crossorigin = 'anonymous';
      utterances.src = 'https://utteranc.es/client.js';
      // content 是要插入评论的地方
      document.getElementById('gitment-container').appendChild(utterances);

    }
  }

  function dark_utterance() {
    const HEAD = check_utterance();
    if (!HEAD) return;
    const message = {
      type: 'set-theme',
      theme: utteranceCommon.Theme
    };
    const utteranceIframe = document.querySelector('iframe');
    utteranceIframe.contentWindow.postMessage(message, 'https://utteranc.es');
  }

  $(document).ready(load_utterance);
  document.addEventListener('pjax:complete', function () {
    load_utterance();
  });

  $('.dark').click(function () {
    setTimeout(() => {
      dark_utterance();
    });
  })

</script>

<style>
  .utterances {
    max-width: inherit !important;
  }
</style>
  


<!-- 鼠标点击特效 -->
<!-- 爱心点击 -->

   
    <script src="/js/cursor/clicklove.js"></script> 
  





    <!-- pjax -->
    

<!-- pjax -->


  <script src="/js/pjax@0.2.8/index.js"></script>
  
    <!-- 样式位于：source/css/_third-party/pjaxanimate.styl -->

<div class="pjax-animate">
  
    <div class="loading-circle"><div id="loader-circle"></div></div>
    <script>
      window.ShowLoading = function() {
        $(".loading-circle").css("display", "block");
      };
      window.HideLoading = function() {
        $(".loading-circle").css("display", "none");
      }
    </script>
  
	<script>
    document.addEventListener('pjax:complete', function () {
      window.HideLoading();
    })
    document.addEventListener('pjax:send', function () {
      window.ShowLoading();
    })
    document.addEventListener('pjax:error', function () {
      window.HideLoading();
    })
	</script>
</div>

  

  <script>
    var pjax = new Pjax({
      elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"]):not([no-pjax])',   // 拦截正常带链接的 a 标签
      selectors: ["#pjax-container","title"],                                   // 根据实际需要确认重载区域
      cacheBust: false,   // url 地址追加时间戳，用以避免浏览器缓存
      timeout: 5000
    });

    document.addEventListener('pjax:send', function (e) {

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = [""];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      $(window).unbind('resize');
      $(window).unbind('scroll');
      $(document).unbind('scroll');
      $(document).unbind('click');
      $('body').unbind('click');

    })
    
    document.addEventListener('pjax:complete', function () {
      $('script[data-pjax], .pjax-reload script').each(function () {
        $(this).parent().append($(this).remove());
      });
    });

    document.addEventListener('pjax:error', function (e) {
      window.location.href = e.triggerElement.href;
    })
    
    // 刷新不从顶部开始
    document.addEventListener("DOMContentLoaded", function () {
      history.scrollRestoration = 'auto';
    })
  </script>



  </body>
</html>